<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>tImageEXR.cpp source code [Modules/Image/Src/tImageEXR.cpp] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="EXR::Gamma "/>
<link rel="stylesheet" href="../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'Modules/Image/Src/tImageEXR.cpp'; var root_path = '../../..'; var data_path = '../../../../data'; var ecma_script_api_version = 2;</script>
<script src='../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Source File </span><a href='../..'>Modules</a>/<a href='..'>Image</a>/<a href='./'>Src</a>/<a href='tImageEXR.cpp.html'>tImageEXR.cpp</a><br><a href='/tacent/index.html'>Home Page</a> &nbsp &nbsp &nbsp &nbsp <a href='/tacent/codebrowser/Modules/index.html'>Browse Root</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>// tImageEXR.cpp</i>&nbsp</td></tr>
<tr><th id="2">2</th><td><i>//</i>&nbsp</td></tr>
<tr><th id="3">3</th><td><i>// This knows how to load and save OpenEXR images (.exr). It knows the details of the exr high dynamic range</i>&nbsp</td></tr>
<tr><th id="4">4</th><td><i>// file format and loads the data into a tPixel array. These tPixels may be 'stolen' by the tPicture's constructor if</i>&nbsp</td></tr>
<tr><th id="5">5</th><td><i>// an EXR file is specified. After the array is stolen the tImageEXR is invalid. This is purely for performance.</i>&nbsp</td></tr>
<tr><th id="6">6</th><td><i>//</i>&nbsp</td></tr>
<tr><th id="7">7</th><td><i>// Copyright (c) 2020-2022, 2024 Tristan Grimmer.</i>&nbsp</td></tr>
<tr><th id="8">8</th><td><i>// Permission to use, copy, modify, and/or distribute this software for any purpose with or without fee is hereby</i>&nbsp</td></tr>
<tr><th id="9">9</th><td><i>// granted, provided that the above copyright notice and this permission notice appear in all copies.</i>&nbsp</td></tr>
<tr><th id="10">10</th><td><i>//</i>&nbsp</td></tr>
<tr><th id="11">11</th><td><i>// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL</i>&nbsp</td></tr>
<tr><th id="12">12</th><td><i>// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,</i>&nbsp</td></tr>
<tr><th id="13">13</th><td><i>// INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN</i>&nbsp</td></tr>
<tr><th id="14">14</th><td><i>// AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR</i>&nbsp</td></tr>
<tr><th id="15">15</th><td><i>// PERFORMANCE OF THIS SOFTWARE.</i>&nbsp</td></tr>
<tr><th id="16">16</th><td><i>//</i>&nbsp</td></tr>
<tr><th id="17">17</th><td><i>// The EXR namespace and functions are a modification of ImageView.cpp from OpenEXR under the following licence:</i>&nbsp</td></tr>
<tr><th id="18">18</th><td><i>//</i>&nbsp</td></tr>
<tr><th id="19">19</th><td><i>// Copyright (c) 2012, Industrial Light &amp; Magic, a division of Lucas Digital Ltd. LLC. All rights reserved.</i>&nbsp</td></tr>
<tr><th id="20">20</th><td><i>//</i>&nbsp</td></tr>
<tr><th id="21">21</th><td><i>// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</i>&nbsp</td></tr>
<tr><th id="22">22</th><td><i>// * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</i>&nbsp</td></tr>
<tr><th id="23">23</th><td><i>// * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</i>&nbsp</td></tr>
<tr><th id="24">24</th><td><i>// * Neither the name of Industrial Light &amp; Magic nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. </i>&nbsp</td></tr>
<tr><th id="25">25</th><td><i>//</i>&nbsp</td></tr>
<tr><th id="26">26</th><td><i>// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</i>&nbsp</td></tr>
<tr><th id="27">27</th><td><i>// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</i>&nbsp</td></tr>
<tr><th id="28">28</th><td><i>// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</i>&nbsp</td></tr>
<tr><th id="29">29</th><td>&nbsp</td></tr>
<tr><th id="30">30</th><td><u>#include &lt;Foundation/tStandard.h&gt;</u>&nbsp</td></tr>
<tr><th id="31">31</th><td><u>#include &lt;Foundation/tString.h&gt;</u>&nbsp</td></tr>
<tr><th id="32">32</th><td><u>#include &lt;System/tMachine.h&gt;</u>&nbsp</td></tr>
<tr><th id="33">33</th><td><u>#include &lt;System/tFile.h&gt;</u>&nbsp</td></tr>
<tr><th id="34">34</th><td><u>#include "Image/tImageEXR.h"</u>&nbsp</td></tr>
<tr><th id="35">35</th><td><u>#include "Image/tPicture.h"</u>&nbsp</td></tr>
<tr><th id="36">36</th><td><u>#include &lt;OpenEXR/loadImage.h&gt;</u>&nbsp</td></tr>
<tr><th id="37">37</th><td><u>#include &lt;OpenEXR/ImfMultiPartInputFile.h&gt;</u>&nbsp</td></tr>
<tr><th id="38">38</th><td><u>#include &lt;OpenEXR/halfFunction.h&gt;</u>&nbsp</td></tr>
<tr><th id="39">39</th><td><b>using</b> <b>namespace</b> <span class="namespace">tSystem</span>;&nbsp</td></tr>
<tr><th id="40">40</th><td><b>using</b> <b>namespace</b> <span class='error' title="expected namespace name">IMF</span>;&nbsp</td></tr>
<tr><th id="41">41</th><td><b>using</b> <b>namespace</b> <span class='error' title="expected namespace name">IMATH</span>;&nbsp</td></tr>
<tr><th id="42">42</th><td><b>using</b> <b>namespace</b> <span class="namespace">tImage</span>;&nbsp</td></tr>
<tr><th id="43">43</th><td>&nbsp</td></tr>
<tr><th id="44">44</th><td>&nbsp</td></tr>
<tr><th id="45">45</th><td><b>namespace</b> <span class="namespace">EXR</span>&nbsp</td></tr>
<tr><th id="46">46</th><td>{&nbsp</td></tr>
<tr><th id="47">47</th><td>	<b>inline</b> <em>float</em> <a class="decl fn" href="#_ZN3EXR7KneeFunEdd" title='EXR::KneeFun' data-ref="_ZN3EXR7KneeFunEdd">KneeFun</a>(<em>double</em> <dfn class="local col4 decl" id="14x" title='x' data-type='double' data-ref="14x">x</dfn>, <em>double</em> <dfn class="local col5 decl" id="15f" title='f' data-type='double' data-ref="15f">f</dfn>);&nbsp</td></tr>
<tr><th id="48">48</th><td>	<em>float</em> <a class="decl fn" href="#_ZN3EXR11FindKneeFunEff" title='EXR::FindKneeFun' data-ref="_ZN3EXR11FindKneeFunEff">FindKneeFun</a>(<em>float</em> <dfn class="local col6 decl" id="16x" title='x' data-type='float' data-ref="16x">x</dfn>, <em>float</em> <dfn class="local col7 decl" id="17y" title='y' data-type='float' data-ref="17y">y</dfn>);&nbsp</td></tr>
<tr><th id="49">49</th><td>	<a class="typedef" href="../../Foundation/Inc/Foundation/tPlatform.h.html#uint8" title='uint8' data-type='unsigned char' data-ref="uint8">uint8</a> <a class="decl fn" href="#_ZN3EXR6DitherEfii" title='EXR::Dither' data-ref="_ZN3EXR6DitherEfii">Dither</a>(<em>float</em> <dfn class="local col8 decl" id="18v" title='v' data-type='float' data-ref="18v">v</dfn>, <em>int</em> <dfn class="local col9 decl" id="19x" title='x' data-type='int' data-ref="19x">x</dfn>, <em>int</em> <dfn class="local col0 decl" id="20y" title='y' data-type='int' data-ref="20y">y</dfn>);&nbsp</td></tr>
<tr><th id="50">50</th><td>&nbsp</td></tr>
<tr><th id="51">51</th><td>	<i>// This fog colour is used when de-fogging.</i>&nbsp</td></tr>
<tr><th id="52">52</th><td>	<em>void</em> <dfn class="decl fn" id="_ZN3EXR16ComputeFogColourERfS0_S0_RKi" title='EXR::ComputeFogColour' data-ref="_ZN3EXR16ComputeFogColourERfS0_S0_RKi">ComputeFogColour</dfn>(<em>float</em>&amp; <dfn class="local col1 decl" id="21fogR" title='fogR' data-type='float &amp;' data-ref="21fogR">fogR</dfn>, <em>float</em>&amp; <dfn class="local col2 decl" id="22fogG" title='fogG' data-type='float &amp;' data-ref="22fogG">fogG</dfn>, <em>float</em>&amp; <dfn class="local col3 decl" id="23fogB" title='fogB' data-type='float &amp;' data-ref="23fogB">fogB</dfn>, <em>const</em> <span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Array&lt;<span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Rgba&gt;&amp; <dfn class="local col4 decl" id="24pixels" title='pixels' data-type='const int &amp;' data-ref="24pixels">pixels</dfn>);&nbsp</td></tr>
<tr><th id="53">53</th><td>&nbsp</td></tr>
<tr><th id="54">54</th><td>	<b>struct</b> <dfn class="type def" id="EXR::Gamma" title='EXR::Gamma' data-ref="EXR::Gamma">Gamma</dfn>&nbsp</td></tr>
<tr><th id="55">55</th><td>	{&nbsp</td></tr>
<tr><th id="56">56</th><td>		<a class="tu decl fn" href="#_ZN3EXR5GammaC1Efffff" title='EXR::Gamma::Gamma' data-type='void EXR::Gamma::Gamma(float gamma, float exposure, float defog, float kneeLow, float kneeHigh)' data-ref="_ZN3EXR5GammaC1Efffff">Gamma</a>(<em>float</em> <dfn class="local col5 decl" id="25gamma" title='gamma' data-type='float' data-ref="25gamma">gamma</dfn>, <em>float</em> <dfn class="local col6 decl" id="26exposure" title='exposure' data-type='float' data-ref="26exposure">exposure</dfn>, <em>float</em> <dfn class="local col7 decl" id="27defog" title='defog' data-type='float' data-ref="27defog">defog</dfn>, <em>float</em> <dfn class="local col8 decl" id="28kneeLow" title='kneeLow' data-type='float' data-ref="28kneeLow">kneeLow</dfn>, <em>float</em> <dfn class="local col9 decl" id="29kneeHigh" title='kneeHigh' data-type='float' data-ref="29kneeHigh">kneeHigh</dfn>);&nbsp</td></tr>
<tr><th id="57">57</th><td>		<em>float</em> <dfn class="tu decl fn" id="_ZN3EXR5GammaclEi" title='EXR::Gamma::operator()' data-type='float EXR::Gamma::operator()(int h)' data-ref="_ZN3EXR5GammaclEi"><b>operator</b>()</dfn>(<span class='error' title="unknown type name &apos;half&apos;">half</span> <dfn class="local col0 decl" id="30h" title='h' data-type='int' data-ref="30h">h</dfn>);&nbsp</td></tr>
<tr><th id="58">58</th><td>		<em>float</em> <dfn class="tu decl field" id="EXR::Gamma::invg" title='EXR::Gamma::invg' data-type='float' data-ref="EXR::Gamma::invg">invg</dfn>, <dfn class="tu decl field" id="EXR::Gamma::m" title='EXR::Gamma::m' data-type='float' data-ref="EXR::Gamma::m">m</dfn>, <dfn class="tu decl field" id="EXR::Gamma::d" title='EXR::Gamma::d' data-type='float' data-ref="EXR::Gamma::d">d</dfn>, <dfn class="tu decl field" id="EXR::Gamma::kl" title='EXR::Gamma::kl' data-type='float' data-ref="EXR::Gamma::kl">kl</dfn>, <dfn class="tu decl field" id="EXR::Gamma::f" title='EXR::Gamma::f' data-type='float' data-ref="EXR::Gamma::f">f</dfn>, <dfn class="tu decl field" id="EXR::Gamma::s" title='EXR::Gamma::s' data-type='float' data-ref="EXR::Gamma::s">s</dfn>;&nbsp</td></tr>
<tr><th id="59">59</th><td>	};&nbsp</td></tr>
<tr><th id="60">60</th><td>}&nbsp</td></tr>
<tr><th id="61">61</th><td>&nbsp</td></tr>
<tr><th id="62">62</th><td>&nbsp</td></tr>
<tr><th id="63">63</th><td><em>float</em> <span class="namespace">EXR::</span><dfn class="decl def fn" id="_ZN3EXR7KneeFunEdd" title='EXR::KneeFun' data-ref="_ZN3EXR7KneeFunEdd">KneeFun</dfn>(<em>double</em> <dfn class="local col1 decl" id="31x" title='x' data-type='double' data-ref="31x">x</dfn>, <em>double</em> <dfn class="local col2 decl" id="32f" title='f' data-type='double' data-ref="32f">f</dfn>)&nbsp</td></tr>
<tr><th id="64">64</th><td>{&nbsp</td></tr>
<tr><th id="65">65</th><td>	<b>return</b> <em>float</em> (<span class='error' title="use of undeclared identifier &apos;IMATH&apos;">IMATH</span>::Math&lt;<em>double</em><span class='error' title="expected &apos;(&apos; for function-style cast or type construction">&gt;</span>::log(x * f + <var>1.0</var>) / f);&nbsp</td></tr>
<tr><th id="66">66</th><td>}&nbsp</td></tr>
<tr><th id="67">67</th><td>&nbsp</td></tr>
<tr><th id="68">68</th><td>	&nbsp</td></tr>
<tr><th id="69">69</th><td><em>float</em> <span class="namespace">EXR::</span><dfn class="decl def fn" id="_ZN3EXR11FindKneeFunEff" title='EXR::FindKneeFun' data-ref="_ZN3EXR11FindKneeFunEff">FindKneeFun</dfn>(<em>float</em> <dfn class="local col3 decl" id="33x" title='x' data-type='float' data-ref="33x">x</dfn>, <em>float</em> <dfn class="local col4 decl" id="34y" title='y' data-type='float' data-ref="34y">y</dfn>)&nbsp</td></tr>
<tr><th id="70">70</th><td>{&nbsp</td></tr>
<tr><th id="71">71</th><td>	<em>float</em> <dfn class="local col5 decl" id="35f0" title='f0' data-type='float' data-ref="35f0">f0</dfn> = <var>0</var>; <em>float</em> <dfn class="local col6 decl" id="36f1" title='f1' data-type='float' data-ref="36f1">f1</dfn> = <var>1</var>;&nbsp</td></tr>
<tr><th id="72">72</th><td>	<b>while</b> (<a class="ref fn" href="#_ZN3EXR7KneeFunEdd" title='EXR::KneeFun' data-ref="_ZN3EXR7KneeFunEdd">KneeFun</a>(<a class="local col3 ref" href="#33x" title='x' data-ref="33x">x</a>, <span class='inlayHint'>f:&nbsp;</span><a class="local col6 ref" href="#36f1" title='f1' data-ref="36f1">f1</a>) &gt; <a class="local col4 ref" href="#34y" title='y' data-ref="34y">y</a>)&nbsp</td></tr>
<tr><th id="73">73</th><td>	{&nbsp</td></tr>
<tr><th id="74">74</th><td>		<a class="local col5 ref" href="#35f0" title='f0' data-ref="35f0">f0</a> = <a class="local col6 ref" href="#36f1" title='f1' data-ref="36f1">f1</a>;&nbsp</td></tr>
<tr><th id="75">75</th><td>		<a class="local col6 ref" href="#36f1" title='f1' data-ref="36f1">f1</a> = <a class="local col6 ref" href="#36f1" title='f1' data-ref="36f1">f1</a> * <var>2</var>;&nbsp</td></tr>
<tr><th id="76">76</th><td>	}&nbsp</td></tr>
<tr><th id="77">77</th><td>&nbsp</td></tr>
<tr><th id="78">78</th><td>	<b>for</b> (<em>int</em> <dfn class="local col7 decl" id="37i" title='i' data-type='int' data-ref="37i">i</dfn> = <var>0</var>; <a class="local col7 ref" href="#37i" title='i' data-ref="37i">i</a> &lt; <var>30</var>; ++<a class="local col7 ref" href="#37i" title='i' data-ref="37i">i</a>)&nbsp</td></tr>
<tr><th id="79">79</th><td>	{&nbsp</td></tr>
<tr><th id="80">80</th><td>		<em>float</em> <dfn class="local col8 decl" id="38f2" title='f2' data-type='float' data-ref="38f2">f2</dfn> = (<a class="local col5 ref" href="#35f0" title='f0' data-ref="35f0">f0</a> + <a class="local col6 ref" href="#36f1" title='f1' data-ref="36f1">f1</a>) / <var>2.0f</var>;&nbsp</td></tr>
<tr><th id="81">81</th><td>		<em>float</em> <dfn class="local col9 decl" id="39y2" title='y2' data-type='float' data-ref="39y2">y2</dfn> = <a class="ref fn" href="#_ZN3EXR7KneeFunEdd" title='EXR::KneeFun' data-ref="_ZN3EXR7KneeFunEdd">KneeFun</a>(<a class="local col3 ref" href="#33x" title='x' data-ref="33x">x</a>, <span class='inlayHint'>f:&nbsp;</span><a class="local col8 ref" href="#38f2" title='f2' data-ref="38f2">f2</a>);&nbsp</td></tr>
<tr><th id="82">82</th><td>		<b>if</b> (<a class="local col9 ref" href="#39y2" title='y2' data-ref="39y2">y2</a> &lt; <a class="local col4 ref" href="#34y" title='y' data-ref="34y">y</a>)&nbsp</td></tr>
<tr><th id="83">83</th><td>			<a class="local col6 ref" href="#36f1" title='f1' data-ref="36f1">f1</a> = <a class="local col8 ref" href="#38f2" title='f2' data-ref="38f2">f2</a>;&nbsp</td></tr>
<tr><th id="84">84</th><td>		<b>else</b>&nbsp</td></tr>
<tr><th id="85">85</th><td>			<a class="local col5 ref" href="#35f0" title='f0' data-ref="35f0">f0</a> = <a class="local col8 ref" href="#38f2" title='f2' data-ref="38f2">f2</a>;&nbsp</td></tr>
<tr><th id="86">86</th><td>	}&nbsp</td></tr>
<tr><th id="87">87</th><td>&nbsp</td></tr>
<tr><th id="88">88</th><td>	<b>return</b> (<a class="local col5 ref" href="#35f0" title='f0' data-ref="35f0">f0</a> + <a class="local col6 ref" href="#36f1" title='f1' data-ref="36f1">f1</a>) / <var>2.0f</var>;&nbsp</td></tr>
<tr><th id="89">89</th><td>}&nbsp</td></tr>
<tr><th id="90">90</th><td>&nbsp</td></tr>
<tr><th id="91">91</th><td>&nbsp</td></tr>
<tr><th id="92">92</th><td><em>void</em> <span class="namespace">EXR::</span><dfn class="decl def fn" id="_ZN3EXR16ComputeFogColourERfS0_S0_RKi" title='EXR::ComputeFogColour' data-ref="_ZN3EXR16ComputeFogColourERfS0_S0_RKi">ComputeFogColour</dfn>(<em>float</em>&amp; <dfn class="local col0 decl" id="40fogR" title='fogR' data-type='float &amp;' data-ref="40fogR">fogR</dfn>, <em>float</em>&amp; <dfn class="local col1 decl" id="41fogG" title='fogG' data-type='float &amp;' data-ref="41fogG">fogG</dfn>, <em>float</em>&amp; <dfn class="local col2 decl" id="42fogB" title='fogB' data-type='float &amp;' data-ref="42fogB">fogB</dfn>, <em>const</em> <span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Array&lt;<span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Rgba&gt;&amp; <dfn class="local col3 decl" id="43pixels" title='pixels' data-type='const int &amp;' data-ref="43pixels">pixels</dfn>)&nbsp</td></tr>
<tr><th id="93">93</th><td>{&nbsp</td></tr>
<tr><th id="94">94</th><td>	<em>double</em> <dfn class="local col4 decl" id="44fogRd" title='fogRd' data-type='double' data-ref="44fogRd">fogRd</dfn> = <var>0.0</var>;&nbsp</td></tr>
<tr><th id="95">95</th><td>	<em>double</em> <dfn class="local col5 decl" id="45fogGd" title='fogGd' data-type='double' data-ref="45fogGd">fogGd</dfn> = <var>0.0</var>;&nbsp</td></tr>
<tr><th id="96">96</th><td>	<em>double</em> <dfn class="local col6 decl" id="46fogBd" title='fogBd' data-type='double' data-ref="46fogBd">fogBd</dfn> = <var>0.0</var>;&nbsp</td></tr>
<tr><th id="97">97</th><td>	<em>double</em> <dfn class="local col7 decl" id="47WeightSum" title='WeightSum' data-type='double' data-ref="47WeightSum">WeightSum</dfn> = <var>0.0</var>;&nbsp</td></tr>
<tr><th id="98">98</th><td>	<em>int</em> <dfn class="local col8 decl" id="48numPixels" title='numPixels' data-type='int' data-ref="48numPixels">numPixels</dfn> = pixels.size();&nbsp</td></tr>
<tr><th id="99">99</th><td>&nbsp</td></tr>
<tr><th id="100">100</th><td>	<b>for</b> (<em>int</em> <dfn class="local col9 decl" id="49j" title='j' data-type='int' data-ref="49j">j</dfn> = <var>0</var>; <a class="local col9 ref" href="#49j" title='j' data-ref="49j">j</a> &lt; <a class="local col8 ref" href="#48numPixels" title='numPixels' data-ref="48numPixels">numPixels</a>; ++<a class="local col9 ref" href="#49j" title='j' data-ref="49j">j</a>)&nbsp</td></tr>
<tr><th id="101">101</th><td>	{&nbsp</td></tr>
<tr><th id="102">102</th><td>		<em>const</em> <span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Rgba&amp; <dfn class="local col0 decl" id="50rawPixel" title='rawPixel' data-type='const int &amp;' data-ref="50rawPixel">rawPixel</dfn> = pixels[j];&nbsp</td></tr>
<tr><th id="103">103</th><td>		<em>float</em> <dfn class="local col1 decl" id="51weight" title='weight' data-type='float' data-ref="51weight">weight</dfn> = tMath::tSaturate(<em>float</em>(rawPixel.a));		<i>// Makes sure transparent pixels don't contribute to the colour.</i>&nbsp</td></tr>
<tr><th id="104">104</th><td>&nbsp</td></tr>
<tr><th id="105">105</th><td>		fogRd += rawPixel.r.isFinite() ? <em>double</em>(rawPixel.r) : <var>0.0</var>;&nbsp</td></tr>
<tr><th id="106">106</th><td>		fogGd += rawPixel.g.isFinite() ? <em>double</em>(rawPixel.g) : <var>0.0</var>;&nbsp</td></tr>
<tr><th id="107">107</th><td>		fogBd += rawPixel.b.isFinite() ? <em>double</em>(rawPixel.b) : <var>0.0</var>;&nbsp</td></tr>
<tr><th id="108">108</th><td>		<a class="local col7 ref" href="#47WeightSum" title='WeightSum' data-ref="47WeightSum">WeightSum</a> += <a class="local col1 ref" href="#51weight" title='weight' data-ref="51weight">weight</a>;&nbsp</td></tr>
<tr><th id="109">109</th><td>	}&nbsp</td></tr>
<tr><th id="110">110</th><td>&nbsp</td></tr>
<tr><th id="111">111</th><td>	<a class="local col4 ref" href="#44fogRd" title='fogRd' data-ref="44fogRd">fogRd</a> /= <a class="local col7 ref" href="#47WeightSum" title='WeightSum' data-ref="47WeightSum">WeightSum</a>;		<a class="local col5 ref" href="#45fogGd" title='fogGd' data-ref="45fogGd">fogGd</a> /= <a class="local col7 ref" href="#47WeightSum" title='WeightSum' data-ref="47WeightSum">WeightSum</a>;		<a class="local col6 ref" href="#46fogBd" title='fogBd' data-ref="46fogBd">fogBd</a> /= <a class="local col7 ref" href="#47WeightSum" title='WeightSum' data-ref="47WeightSum">WeightSum</a>;&nbsp</td></tr>
<tr><th id="112">112</th><td>	<a class="local col0 ref" href="#40fogR" title='fogR' data-ref="40fogR">fogR</a> = <em>float</em>(<a class="local col4 ref" href="#44fogRd" title='fogRd' data-ref="44fogRd">fogRd</a>);	<a class="local col1 ref" href="#41fogG" title='fogG' data-ref="41fogG">fogG</a> = <em>float</em>(<a class="local col5 ref" href="#45fogGd" title='fogGd' data-ref="45fogGd">fogGd</a>);	<a class="local col2 ref" href="#42fogB" title='fogB' data-ref="42fogB">fogB</a> = <em>float</em>(<a class="local col6 ref" href="#46fogBd" title='fogBd' data-ref="46fogBd">fogBd</a>);&nbsp</td></tr>
<tr><th id="113">113</th><td>}&nbsp</td></tr>
<tr><th id="114">114</th><td>&nbsp</td></tr>
<tr><th id="115">115</th><td>&nbsp</td></tr>
<tr><th id="116">116</th><td><a class="typedef" href="../../Foundation/Inc/Foundation/tPlatform.h.html#uint8" title='uint8' data-type='unsigned char' data-ref="uint8">uint8</a> <span class="namespace">EXR::</span><dfn class="decl def fn" id="_ZN3EXR6DitherEfii" title='EXR::Dither' data-ref="_ZN3EXR6DitherEfii">Dither</dfn>(<em>float</em> <dfn class="local col2 decl" id="52v" title='v' data-type='float' data-ref="52v">v</dfn>, <em>int</em> <dfn class="local col3 decl" id="53x" title='x' data-type='int' data-ref="53x">x</dfn>, <em>int</em> <dfn class="local col4 decl" id="54y" title='y' data-type='int' data-ref="54y">y</dfn>)&nbsp</td></tr>
<tr><th id="117">117</th><td>{&nbsp</td></tr>
<tr><th id="118">118</th><td>	<em>static</em> <em>const</em> <em>float</em> <dfn class="local col5 decl" id="55d" title='d' data-type='const float[4][4]' data-ref="55d">d</dfn>[<var>4</var>][<var>4</var>] =&nbsp</td></tr>
<tr><th id="119">119</th><td>	{&nbsp</td></tr>
<tr><th id="120">120</th><td>		{	<var>00.0f</var>/<var>16.0f</var>,	<var>08.0f</var>/<var>16.0f</var>,	<var>02.0f</var>/<var>16.0f</var>,	<var>10.0f</var>/<var>16.0f</var>		},&nbsp</td></tr>
<tr><th id="121">121</th><td>		{	<var>12.0f</var>/<var>16.0f</var>,	<var>04.0f</var>/<var>16.0f</var>,	<var>14.0f</var>/<var>16.0f</var>,	<var>06.0f</var>/<var>16.0f</var>		},&nbsp</td></tr>
<tr><th id="122">122</th><td>		{	<var>03.0f</var>/<var>16.0f</var>,	<var>11.0f</var>/<var>16.0f</var>,	<var>01.0f</var>/<var>16.0f</var>,	<var>09.0f</var>/<var>16.0f</var>		},&nbsp</td></tr>
<tr><th id="123">123</th><td>		{	<var>15.0f</var>/<var>16.0f</var>,	<var>07.0f</var>/<var>16.0f</var>,	<var>13.0f</var>/<var>16.0f</var>,	<var>05.0f</var>/<var>16.0f</var>		}&nbsp</td></tr>
<tr><th id="124">124</th><td>	};&nbsp</td></tr>
<tr><th id="125">125</th><td>&nbsp</td></tr>
<tr><th id="126">126</th><td>	<b>return</b> <a class="typedef" href="../../Foundation/Inc/Foundation/tPlatform.h.html#uint8" title='uint8' data-type='unsigned char' data-ref="uint8">uint8</a>(<a class="local col2 ref" href="#52v" title='v' data-ref="52v">v</a> + <a class="local col5 ref" href="#55d" title='d' data-ref="55d">d</a>[<a class="local col4 ref" href="#54y" title='y' data-ref="54y">y</a>&amp;<var>3</var>][<a class="local col3 ref" href="#53x" title='x' data-ref="53x">x</a>&amp;<var>3</var>]);&nbsp</td></tr>
<tr><th id="127">127</th><td>}&nbsp</td></tr>
<tr><th id="128">128</th><td>&nbsp</td></tr>
<tr><th id="129">129</th><td>&nbsp</td></tr>
<tr><th id="130">130</th><td><span class="namespace">EXR::</span><a class="type" href="#EXR::Gamma" title='EXR::Gamma' data-ref="EXR::Gamma">Gamma</a>::<dfn class="tu decl def fn" id="_ZN3EXR5GammaC1Efffff" title='EXR::Gamma::Gamma' data-type='void EXR::Gamma::Gamma(float gamma, float exposure, float defog, float kneeLow, float kneeHigh)' data-ref="_ZN3EXR5GammaC1Efffff">Gamma</dfn>(<em>float</em> <dfn class="local col6 decl" id="56gamma" title='gamma' data-type='float' data-ref="56gamma">gamma</dfn>, <em>float</em> <dfn class="local col7 decl" id="57exposure" title='exposure' data-type='float' data-ref="57exposure">exposure</dfn>, <em>float</em> <dfn class="local col8 decl" id="58defog" title='defog' data-type='float' data-ref="58defog">defog</dfn>, <em>float</em> <dfn class="local col9 decl" id="59kneeLow" title='kneeLow' data-type='float' data-ref="59kneeLow">kneeLow</dfn>, <em>float</em> <dfn class="local col0 decl" id="60kneeHigh" title='kneeHigh' data-type='float' data-ref="60kneeHigh">kneeHigh</dfn>) :&nbsp</td></tr>
<tr><th id="131">131</th><td>	<a class="tu member field" href="#EXR::Gamma::invg" title='EXR::Gamma::invg' data-use='w' data-ref="EXR::Gamma::invg">invg</a>(<var>1.0f</var>/<a class="local col6 ref" href="#56gamma" title='gamma' data-ref="56gamma">gamma</a>),&nbsp</td></tr>
<tr><th id="132">132</th><td>	<a class="tu member field" href="#EXR::Gamma::m" title='EXR::Gamma::m' data-use='w' data-ref="EXR::Gamma::m">m</a>(<span class="namespace">tMath::</span><a class="ref fn" href="../../Foundation/Inc/Foundation/tFundamentals.h.html#_ZN5tMath4tPowEff" title='tMath::tPow' data-ref="_ZN5tMath4tPowEff">tPow</a>(<span class='inlayHint'>a:&nbsp;</span><var>2.0f</var>, <span class='inlayHint'>b:&nbsp;</span><a class="local col7 ref" href="#57exposure" title='exposure' data-ref="57exposure">exposure</a> + <var>2.47393f</var>)),&nbsp</td></tr>
<tr><th id="133">133</th><td>	<a class="tu member field" href="#EXR::Gamma::d" title='EXR::Gamma::d' data-use='w' data-ref="EXR::Gamma::d">d</a>(<a class="local col8 ref" href="#58defog" title='defog' data-ref="58defog">defog</a>),&nbsp</td></tr>
<tr><th id="134">134</th><td>	<a class="tu member field" href="#EXR::Gamma::kl" title='EXR::Gamma::kl' data-use='w' data-ref="EXR::Gamma::kl">kl</a>(<span class="namespace">tMath::</span><a class="ref fn" href="../../Foundation/Inc/Foundation/tFundamentals.h.html#_ZN5tMath4tPowEff" title='tMath::tPow' data-ref="_ZN5tMath4tPowEff">tPow</a>(<span class='inlayHint'>a:&nbsp;</span><var>2.0f</var>, <span class='inlayHint'>b:&nbsp;</span><a class="local col9 ref" href="#59kneeLow" title='kneeLow' data-ref="59kneeLow">kneeLow</a>)),&nbsp</td></tr>
<tr><th id="135">135</th><td>	<a class="tu member field" href="#EXR::Gamma::f" title='EXR::Gamma::f' data-use='w' data-ref="EXR::Gamma::f">f</a>(<a class="ref fn" href="#_ZN3EXR11FindKneeFunEff" title='EXR::FindKneeFun' data-ref="_ZN3EXR11FindKneeFunEff">FindKneeFun</a>(<span class='inlayHint'>x:&nbsp;</span><span class="namespace">tMath::</span><a class="ref fn" href="../../Foundation/Inc/Foundation/tFundamentals.h.html#_ZN5tMath4tPowEff" title='tMath::tPow' data-ref="_ZN5tMath4tPowEff">tPow</a>(<span class='inlayHint'>a:&nbsp;</span><var>2.0f</var>, <span class='inlayHint'>b:&nbsp;</span><a class="local col0 ref" href="#60kneeHigh" title='kneeHigh' data-ref="60kneeHigh">kneeHigh</a>) - <a class="tu member field" href="#EXR::Gamma::kl" title='EXR::Gamma::kl' data-use='r' data-ref="EXR::Gamma::kl">kl</a>, <span class='inlayHint'>y:&nbsp;</span><span class="namespace">tMath::</span><a class="ref fn" href="../../Foundation/Inc/Foundation/tFundamentals.h.html#_ZN5tMath4tPowEff" title='tMath::tPow' data-ref="_ZN5tMath4tPowEff">tPow</a>(<span class='inlayHint'>a:&nbsp;</span><var>2.0f</var>, <span class='inlayHint'>b:&nbsp;</span><var>3.5f</var>) - <a class="tu member field" href="#EXR::Gamma::kl" title='EXR::Gamma::kl' data-use='r' data-ref="EXR::Gamma::kl">kl</a>)),&nbsp</td></tr>
<tr><th id="136">136</th><td>	<a class="tu member field" href="#EXR::Gamma::s" title='EXR::Gamma::s' data-use='w' data-ref="EXR::Gamma::s">s</a>(<var>255.0f</var> * <span class="namespace">tMath::</span><a class="ref fn" href="../../Foundation/Inc/Foundation/tFundamentals.h.html#_ZN5tMath4tPowEff" title='tMath::tPow' data-ref="_ZN5tMath4tPowEff">tPow</a>(<span class='inlayHint'>a:&nbsp;</span><var>2.0f</var>, <span class='inlayHint'>b:&nbsp;</span>-<var>3.5f</var> * <a class="tu member field" href="#EXR::Gamma::invg" title='EXR::Gamma::invg' data-use='r' data-ref="EXR::Gamma::invg">invg</a>))&nbsp</td></tr>
<tr><th id="137">137</th><td>{&nbsp</td></tr>
<tr><th id="138">138</th><td>}&nbsp</td></tr>
<tr><th id="139">139</th><td>&nbsp</td></tr>
<tr><th id="140">140</th><td>&nbsp</td></tr>
<tr><th id="141">141</th><td><em>float</em> <span class="namespace">EXR::</span><a class="type" href="#EXR::Gamma" title='EXR::Gamma' data-ref="EXR::Gamma">Gamma</a>::<dfn class="tu decl def fn" id="_ZN3EXR5GammaclEi" title='EXR::Gamma::operator()' data-type='float EXR::Gamma::operator()(int h)' data-ref="_ZN3EXR5GammaclEi"><b>operator</b>()</dfn>(<span class='error' title="unknown type name &apos;half&apos;">half</span> <dfn class="local col1 decl" id="61h" title='h' data-type='int' data-ref="61h">h</dfn>)&nbsp</td></tr>
<tr><th id="142">142</th><td>{&nbsp</td></tr>
<tr><th id="143">143</th><td>	<em>float</em> <dfn class="local col2 decl" id="62x" title='x' data-type='float' data-ref="62x">x</dfn> = tMath::tMax(<var>0.0f</var>, (h - d));		<i>// Defog</i>&nbsp</td></tr>
<tr><th id="144">144</th><td>	<a class="local col2 ref" href="#62x" title='x' data-ref="62x">x</a> *= <a class="tu member field" href="#EXR::Gamma::m" title='EXR::Gamma::m' data-use='r' data-ref="EXR::Gamma::m">m</a>;										<i>// Exposure</i>&nbsp</td></tr>
<tr><th id="145">145</th><td>	<b>if</b> (<a class="local col2 ref" href="#62x" title='x' data-ref="62x">x</a> &gt; <a class="tu member field" href="#EXR::Gamma::kl" title='EXR::Gamma::kl' data-use='r' data-ref="EXR::Gamma::kl">kl</a>) <a class="local col2 ref" href="#62x" title='x' data-ref="62x">x</a> = <a class="tu member field" href="#EXR::Gamma::kl" title='EXR::Gamma::kl' data-use='r' data-ref="EXR::Gamma::kl">kl</a> + <a class="ref fn" href="#_ZN3EXR7KneeFunEdd" title='EXR::KneeFun' data-ref="_ZN3EXR7KneeFunEdd">KneeFun</a>(<span class='inlayHint'>x:&nbsp;</span><a class="local col2 ref" href="#62x" title='x' data-ref="62x">x</a> - <a class="tu member field" href="#EXR::Gamma::kl" title='EXR::Gamma::kl' data-use='r' data-ref="EXR::Gamma::kl">kl</a>, <a class="tu member field" href="#EXR::Gamma::f" title='EXR::Gamma::f' data-use='r' data-ref="EXR::Gamma::f">f</a>);	<i>// Knee</i>&nbsp</td></tr>
<tr><th id="146">146</th><td>	<a class="local col2 ref" href="#62x" title='x' data-ref="62x">x</a> = <span class="namespace">tMath::</span><a class="ref fn" href="../../Foundation/Inc/Foundation/tFundamentals.h.html#_ZN5tMath4tPowEff" title='tMath::tPow' data-ref="_ZN5tMath4tPowEff">tPow</a>(<span class='inlayHint'>a:&nbsp;</span><a class="local col2 ref" href="#62x" title='x' data-ref="62x">x</a>, <span class='inlayHint'>b:&nbsp;</span><a class="tu member field" href="#EXR::Gamma::invg" title='EXR::Gamma::invg' data-use='r' data-ref="EXR::Gamma::invg">invg</a>);					<i>// Gamma</i>&nbsp</td></tr>
<tr><th id="147">147</th><td>	<b>return</b> <span class="namespace">tMath::</span><a class="ref fn" href="../../Foundation/Inc/Foundation/tFundamentals.h.html#_ZN5tMath6tClampET_S0_S0_" title='tMath::tClamp' data-ref="_ZN5tMath6tClampET_S0_S0_">tClamp</a>(<span class='inlayHint'>val:&nbsp;</span><a class="local col2 ref" href="#62x" title='x' data-ref="62x">x</a>*<a class="tu member field" href="#EXR::Gamma::s" title='EXR::Gamma::s' data-use='r' data-ref="EXR::Gamma::s">s</a>, <span class='inlayHint'>min:&nbsp;</span><var>0.0f</var>, <span class='inlayHint'>max:&nbsp;</span><var>255.0f</var>);	<i>// Clamp</i>&nbsp</td></tr>
<tr><th id="148">148</th><td>}&nbsp</td></tr>
<tr><th id="149">149</th><td>&nbsp</td></tr>
<tr><th id="150">150</th><td>&nbsp</td></tr>
<tr><th id="151">151</th><td><em>bool</em> <a class="type" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR" title='tImage::tImageEXR' data-ref="tImage::tImageEXR">tImageEXR</a>::<dfn class="decl def fn" id="_ZN6tImage9tImageEXR4LoadERK7tStringRKNS0_10LoadParamsE" title='tImage::tImageEXR::Load' data-ref="_ZN6tImage9tImageEXR4LoadERK7tStringRKNS0_10LoadParamsE">Load</dfn>(<em>const</em> <a class="type" href="../../Foundation/Inc/Foundation/tString.h.html#tString" title='tString' data-ref="tString">tString</a>&amp; <dfn class="local col3 decl" id="63exrFile" title='exrFile' data-type='const tString &amp;' data-ref="63exrFile">exrFile</dfn>, <em>const</em> <a class="type" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::LoadParams" title='tImage::tImageEXR::LoadParams' data-ref="tImage::tImageEXR::LoadParams">LoadParams</a>&amp; <dfn class="local col4 decl" id="64loadParams" title='loadParams' data-type='const tImage::tImageEXR::LoadParams &amp;' data-ref="64loadParams">loadParams</dfn>)&nbsp</td></tr>
<tr><th id="152">152</th><td>{&nbsp</td></tr>
<tr><th id="153">153</th><td>	<a class="virtual member fn" href="../Inc/Image/tImageEXR.h.html#_ZN6tImage9tImageEXR5ClearEv" title='tImage::tImageEXR::Clear' data-ref="_ZN6tImage9tImageEXR5ClearEv">Clear</a>();&nbsp</td></tr>
<tr><th id="154">154</th><td>	<b>if</b> (<span class="namespace">tSystem::</span><a class="ref fn" href="../../System/Inc/System/tFile.h.html#_ZN7tSystem12tGetFileTypeERK7tString" title='tSystem::tGetFileType' data-ref="_ZN7tSystem12tGetFileTypeERK7tString">tGetFileType</a>(<span class='inlayHint'>file:&nbsp;</span><a class="local col3 ref" href="#63exrFile" title='exrFile' data-ref="63exrFile">exrFile</a>) != <span class="namespace">tSystem::</span><a class="type" href="../../System/Inc/System/tFile.h.html#tSystem::tFileType" title='tSystem::tFileType' data-ref="tSystem::tFileType">tFileType</a>::<a class="enum" href="../../System/Inc/System/tFile.h.html#tSystem::tFileType::EXR" title='tSystem::tFileType::EXR' data-ref="tSystem::tFileType::EXR">EXR</a>)&nbsp</td></tr>
<tr><th id="155">155</th><td>		<b>return</b> <b>false</b>;&nbsp</td></tr>
<tr><th id="156">156</th><td>&nbsp</td></tr>
<tr><th id="157">157</th><td>	<b>if</b> (!<a class="ref fn" href="../../System/Inc/System/tFile.h.html#_ZN7tSystem11tFileExistsERK7tString" title='tSystem::tFileExists' data-ref="_ZN7tSystem11tFileExistsERK7tString">tFileExists</a>(<span class='inlayHint'>file:&nbsp;</span><a class="local col3 ref" href="#63exrFile" title='exrFile' data-ref="63exrFile">exrFile</a>))&nbsp</td></tr>
<tr><th id="158">158</th><td>		<b>return</b> <b>false</b>;&nbsp</td></tr>
<tr><th id="159">159</th><td>&nbsp</td></tr>
<tr><th id="160">160</th><td>	<em>float</em> <dfn class="local col5 decl" id="65defog" title='defog' data-type='float' data-ref="65defog">defog</dfn>			= <a class="local col4 ref" href="#64loadParams" title='loadParams' data-ref="64loadParams">loadParams</a>.<a class="ref field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::LoadParams::Defog" title='tImage::tImageEXR::LoadParams::Defog' data-ref="tImage::tImageEXR::LoadParams::Defog">Defog</a>;&nbsp</td></tr>
<tr><th id="161">161</th><td>	<em>float</em> <dfn class="local col6 decl" id="66exposure" title='exposure' data-type='float' data-ref="66exposure">exposure</dfn>		= <a class="local col4 ref" href="#64loadParams" title='loadParams' data-ref="64loadParams">loadParams</a>.<a class="ref field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::LoadParams::Exposure" title='tImage::tImageEXR::LoadParams::Exposure' data-ref="tImage::tImageEXR::LoadParams::Exposure">Exposure</a>;&nbsp</td></tr>
<tr><th id="162">162</th><td>	<em>float</em> <dfn class="local col7 decl" id="67kneeLow" title='kneeLow' data-type='float' data-ref="67kneeLow">kneeLow</dfn>		= <a class="local col4 ref" href="#64loadParams" title='loadParams' data-ref="64loadParams">loadParams</a>.<a class="ref field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::LoadParams::KneeLow" title='tImage::tImageEXR::LoadParams::KneeLow' data-ref="tImage::tImageEXR::LoadParams::KneeLow">KneeLow</a>;&nbsp</td></tr>
<tr><th id="163">163</th><td>	<em>float</em> <dfn class="local col8 decl" id="68kneeHigh" title='kneeHigh' data-type='float' data-ref="68kneeHigh">kneeHigh</dfn>		= <a class="local col4 ref" href="#64loadParams" title='loadParams' data-ref="64loadParams">loadParams</a>.<a class="ref field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::LoadParams::KneeHigh" title='tImage::tImageEXR::LoadParams::KneeHigh' data-ref="tImage::tImageEXR::LoadParams::KneeHigh">KneeHigh</a>;&nbsp</td></tr>
<tr><th id="164">164</th><td>	<em>float</em> <dfn class="local col9 decl" id="69gamma" title='gamma' data-type='float' data-ref="69gamma">gamma</dfn>			= <a class="local col4 ref" href="#64loadParams" title='loadParams' data-ref="64loadParams">loadParams</a>.<a class="ref field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::LoadParams::Gamma" title='tImage::tImageEXR::LoadParams::Gamma' data-ref="tImage::tImageEXR::LoadParams::Gamma">Gamma</a>;&nbsp</td></tr>
<tr><th id="165">165</th><td>&nbsp</td></tr>
<tr><th id="166">166</th><td>	<i>// Leave two cores free unless we are on a three core or lower machine, in which case we always use a min of 2 threads.</i>&nbsp</td></tr>
<tr><th id="167">167</th><td>	<em>int</em> <dfn class="local col0 decl" id="70numThreads" title='numThreads' data-type='int' data-ref="70numThreads">numThreads</dfn> = <span class="namespace">tMath::</span><a class="ref fn" href="../../Foundation/Inc/Foundation/tFundamentals.h.html#_ZN5tMath9tClampMinET_S0_" title='tMath::tClampMin' data-ref="_ZN5tMath9tClampMinET_S0_">tClampMin</a>(<span class='inlayHint'>val:&nbsp;</span>(<span class="namespace">tSystem::</span><a class="ref fn" href="../../System/Inc/System/tMachine.h.html#_ZN7tSystem12tGetNumCoresEv" title='tSystem::tGetNumCores' data-ref="_ZN7tSystem12tGetNumCoresEv">tGetNumCores</a>()) - <var>2</var>, <span class='inlayHint'>min:&nbsp;</span><var>2</var>);&nbsp</td></tr>
<tr><th id="168">168</th><td>	<span class='error' title="use of undeclared identifier &apos;setGlobalThreadCount&apos;">setGlobalThreadCount</span>(<a class="local col0 ref" href="#70numThreads" title='numThreads' data-ref="70numThreads">numThreads</a>);&nbsp</td></tr>
<tr><th id="169">169</th><td>&nbsp</td></tr>
<tr><th id="170">170</th><td>	<em>int</em> <dfn class="local col1 decl" id="71outZsize" title='outZsize' data-type='int' data-ref="71outZsize">outZsize</dfn> = <var>0</var>;&nbsp</td></tr>
<tr><th id="171">171</th><td>	<span class='error' title="unknown type name &apos;Header&apos;">Header</span> <dfn class="local col2 decl" id="72outHeader" title='outHeader' data-type='int' data-ref="72outHeader">outHeader</dfn>;&nbsp</td></tr>
<tr><th id="172">172</th><td>	<span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Array&lt;<span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Rgba&gt; <span class='error' title="use of undeclared identifier &apos;pixels&apos;">pixels</span>;&nbsp</td></tr>
<tr><th id="173">173</th><td>	<span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Array&lt;<em>float</em><span class='error' title="expected &apos;(&apos; for function-style cast or type construction">*</span><span class='error' title="expected expression">&gt;</span> <span class='error' title="use of undeclared identifier &apos;zbuffer&apos;; did you mean &apos;setbuffer&apos;?">zbuffer</span>;&nbsp</td></tr>
<tr><th id="174">174</th><td>	<span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Array&lt;<span class='error' title="unexpected type name &apos;uint&apos;: expected expression">uint</span>&gt; <span class='error' title="use of undeclared identifier &apos;sampleCount&apos;">sampleCount</span>;&nbsp</td></tr>
<tr><th id="175">175</th><td>&nbsp</td></tr>
<tr><th id="176">176</th><td>	<span class='error' title="unknown type name &apos;MultiPartInputFile&apos;">MultiPartInputFile</span> <dfn class="local col3 decl" id="73mpfile" title='mpfile' data-type='int' data-ref="73mpfile">mpfile</dfn>(exrFile.Chr());&nbsp</td></tr>
<tr><th id="177">177</th><td>	<em>int</em> <dfn class="local col4 decl" id="74numParts" title='numParts' data-type='int' data-ref="74numParts">numParts</dfn> = mpfile.parts();&nbsp</td></tr>
<tr><th id="178">178</th><td>	<b>if</b> (<a class="local col4 ref" href="#74numParts" title='numParts' data-ref="74numParts">numParts</a> &lt;= <var>0</var>)&nbsp</td></tr>
<tr><th id="179">179</th><td>		<b>return</b> <b>false</b>;&nbsp</td></tr>
<tr><th id="180">180</th><td>&nbsp</td></tr>
<tr><th id="181">181</th><td>	<b>for</b> (<em>int</em> <dfn class="local col5 decl" id="75partNum" title='partNum' data-type='int' data-ref="75partNum">partNum</dfn> = <var>0</var>; <a class="local col5 ref" href="#75partNum" title='partNum' data-ref="75partNum">partNum</a> &lt; <a class="local col4 ref" href="#74numParts" title='numParts' data-ref="74numParts">numParts</a>; <a class="local col5 ref" href="#75partNum" title='partNum' data-ref="75partNum">partNum</a>++)&nbsp</td></tr>
<tr><th id="182">182</th><td>	{&nbsp</td></tr>
<tr><th id="183">183</th><td>		<b>try</b>&nbsp</td></tr>
<tr><th id="184">184</th><td>		{&nbsp</td></tr>
<tr><th id="185">185</th><td>			<em>bool</em> <dfn class="local col6 decl" id="76preview" title='preview' data-type='bool' data-ref="76preview">preview</dfn> = <b>false</b>;&nbsp</td></tr>
<tr><th id="186">186</th><td>			<em>int</em> <dfn class="local col7 decl" id="77lx" title='lx' data-type='int' data-ref="77lx">lx</dfn> = -<var>1</var>; <em>int</em> <dfn class="local col8 decl" id="78ly" title='ly' data-type='int' data-ref="78ly">ly</dfn> = -<var>1</var>;		<i>// For tiled image shows level (lx,ly)</i>&nbsp</td></tr>
<tr><th id="187">187</th><td>			<em>bool</em> <dfn class="local col9 decl" id="79compositeDeep" title='compositeDeep' data-type='bool' data-ref="79compositeDeep">compositeDeep</dfn> = <b>true</b>;&nbsp</td></tr>
<tr><th id="188">188</th><td>&nbsp</td></tr>
<tr><th id="189">189</th><td>			EXR::loadImage&nbsp</td></tr>
<tr><th id="190">190</th><td>			(&nbsp</td></tr>
<tr><th id="191">191</th><td>				exrFile.Chr(),&nbsp</td></tr>
<tr><th id="192">192</th><td>				<b>nullptr</b>,					<i>// Channels. Null means all.</i>&nbsp</td></tr>
<tr><th id="193">193</th><td>				<b>nullptr</b>,					<i>// Layers. O means first one.</i>&nbsp</td></tr>
<tr><th id="194">194</th><td>				preview, lx, ly,&nbsp</td></tr>
<tr><th id="195">195</th><td>				partNum,&nbsp</td></tr>
<tr><th id="196">196</th><td>				outZsize, outHeader,&nbsp</td></tr>
<tr><th id="197">197</th><td>				<span class='error' title="use of undeclared identifier &apos;pixels&apos;">pixels</span>, <span class='error' title="use of undeclared identifier &apos;zbuffer&apos;; did you mean &apos;setbuffer&apos;?">zbuffer</span>, <span class='error' title="use of undeclared identifier &apos;sampleCount&apos;">sampleCount</span>,&nbsp</td></tr>
<tr><th id="198">198</th><td>				compositeDeep&nbsp</td></tr>
<tr><th id="199">199</th><td>			);&nbsp</td></tr>
<tr><th id="200">200</th><td>		}&nbsp</td></tr>
<tr><th id="201">201</th><td>		<b>catch</b> (<span class='error' title="use of undeclared identifier &apos;IEX_NAMESPACE&apos;">IEX_NAMESPACE</span>::BaseExc&amp; <dfn class="local col0 decl" id="80err" title='err' data-type='int &amp;' data-ref="80err">err</dfn>)&nbsp</td></tr>
<tr><th id="202">202</th><td>		{&nbsp</td></tr>
<tr><th id="203">203</th><td>			tPrintf(<q>"Error: Can't read exr file. %s\n"</q>, err.what());&nbsp</td></tr>
<tr><th id="204">204</th><td>			<b>return</b> <b>false</b>;&nbsp</td></tr>
<tr><th id="205">205</th><td>		}&nbsp</td></tr>
<tr><th id="206">206</th><td>&nbsp</td></tr>
<tr><th id="207">207</th><td>		<em>const</em> <span class='error' title="unknown type name &apos;Box2i&apos;">Box2i</span>&amp; <dfn class="local col1 decl" id="81displayWindow" title='displayWindow' data-type='const int &amp;' data-ref="81displayWindow">displayWindow</dfn> = outHeader.displayWindow();&nbsp</td></tr>
<tr><th id="208">208</th><td>		<em>const</em> <span class='error' title="unknown type name &apos;Box2i&apos;">Box2i</span>&amp; <dfn class="local col2 decl" id="82dataWindow" title='dataWindow' data-type='const int &amp;' data-ref="82dataWindow">dataWindow</dfn> = outHeader.dataWindow();&nbsp</td></tr>
<tr><th id="209">209</th><td>		<em>float</em> <dfn class="local col3 decl" id="83pixelAspectRatio" title='pixelAspectRatio' data-type='float' data-ref="83pixelAspectRatio">pixelAspectRatio</dfn> = outHeader.pixelAspectRatio();&nbsp</td></tr>
<tr><th id="210">210</th><td>		<em>int</em> <dfn class="local col4 decl" id="84w" title='w' data-type='int' data-ref="84w">w</dfn>		= displayWindow.max.x - displayWindow.min.x + <var>1</var>;&nbsp</td></tr>
<tr><th id="211">211</th><td>		<em>int</em> <dfn class="local col5 decl" id="85h" title='h' data-type='int' data-ref="85h">h</dfn>		= displayWindow.max.y - displayWindow.min.y + <var>1</var>;&nbsp</td></tr>
<tr><th id="212">212</th><td>		<em>int</em> <dfn class="local col6 decl" id="86dx" title='dx' data-type='int' data-ref="86dx">dx</dfn>		= dataWindow.min.x - displayWindow.min.x;&nbsp</td></tr>
<tr><th id="213">213</th><td>		<em>int</em> <dfn class="local col7 decl" id="87dy" title='dy' data-type='int' data-ref="87dy">dy</dfn>		= dataWindow.min.y - displayWindow.min.y;&nbsp</td></tr>
<tr><th id="214">214</th><td>		<em>int</em> <dfn class="local col8 decl" id="88width" title='width' data-type='int' data-ref="88width">width</dfn>	= dataWindow.max.x - dataWindow.min.x + <var>1</var>;&nbsp</td></tr>
<tr><th id="215">215</th><td>		<em>int</em> <dfn class="local col9 decl" id="89height" title='height' data-type='int' data-ref="89height">height</dfn>	= dataWindow.max.y - dataWindow.min.y + <var>1</var>;&nbsp</td></tr>
<tr><th id="216">216</th><td>&nbsp</td></tr>
<tr><th id="217">217</th><td>		<i>// Set width, height, and allocate and set Pixels.</i>&nbsp</td></tr>
<tr><th id="218">218</th><td>		<a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a>* <dfn class="local col0 decl" id="90newFrame" title='newFrame' data-type='tImage::tFrame *' data-ref="90newFrame">newFrame</dfn> = <b>new</b> <a class="ref fn fake" href="../Inc/Image/tFrame.h.html#_ZN6tImage6tFrameC1Ev" title='tImage::tFrame::tFrame' data-ref="_ZN6tImage6tFrameC1Ev"></a><a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a>;&nbsp</td></tr>
<tr><th id="219">219</th><td>		<a class="local col0 ref" href="#90newFrame" title='newFrame' data-ref="90newFrame">newFrame</a>-&gt;<a class="ref field" href="../Inc/Image/tFrame.h.html#tImage::tFrame::PixelFormatSrc" title='tImage::tFrame::PixelFormatSrc' data-ref="tImage::tFrame::PixelFormatSrc">PixelFormatSrc</a> = <a class="type" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat" title='tImage::tPixelFormat' data-ref="tImage::tPixelFormat">tPixelFormat</a>::<a class="enum" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat::OPENEXR" title='tImage::tPixelFormat::OPENEXR' data-ref="tImage::tPixelFormat::OPENEXR">OPENEXR</a>;&nbsp</td></tr>
<tr><th id="220">220</th><td>		<a class="local col0 ref" href="#90newFrame" title='newFrame' data-ref="90newFrame">newFrame</a>-&gt;<a class="ref field" href="../Inc/Image/tFrame.h.html#tImage::tFrame::Width" title='tImage::tFrame::Width' data-ref="tImage::tFrame::Width">Width</a> = <a class="local col8 ref" href="#88width" title='width' data-ref="88width">width</a>;&nbsp</td></tr>
<tr><th id="221">221</th><td>		<a class="local col0 ref" href="#90newFrame" title='newFrame' data-ref="90newFrame">newFrame</a>-&gt;<a class="ref field" href="../Inc/Image/tFrame.h.html#tImage::tFrame::Height" title='tImage::tFrame::Height' data-ref="tImage::tFrame::Height">Height</a> = <a class="local col9 ref" href="#89height" title='height' data-ref="89height">height</a>;&nbsp</td></tr>
<tr><th id="222">222</th><td>		<a class="local col0 ref" href="#90newFrame" title='newFrame' data-ref="90newFrame">newFrame</a>-&gt;<a class="ref field" href="../Inc/Image/tFrame.h.html#tImage::tFrame::Pixels" title='tImage::tFrame::Pixels' data-ref="tImage::tFrame::Pixels">Pixels</a> = <b>new</b> <a class="ref fn fake" href="../../Math/Inc/Math/tColour.h.html#_ZN9tColour4bC1Ev" title='tColour4b::tColour4b' data-ref="_ZN9tColour4bC1Ev"></a><a class="typedef" href="../../Math/Inc/Math/tColour.h.html#tPixel4b" title='tPixel4b' data-type='tColour4b' data-ref="tPixel4b">tPixel4b</a>[<a class="local col8 ref" href="#88width" title='width' data-ref="88width">width</a>*<a class="local col9 ref" href="#89height" title='height' data-ref="89height">height</a>];&nbsp</td></tr>
<tr><th id="223">223</th><td>&nbsp</td></tr>
<tr><th id="224">224</th><td>		<i>// Map floating-point pixel values 0.0 and 1.0 to the display's white and black respectively.</i>&nbsp</td></tr>
<tr><th id="225">225</th><td><i>		// if bool zerooneexposure true.</i>&nbsp</td></tr>
<tr><th id="226">226</th><td><i>		// exposure = 1.02607f;</i>&nbsp</td></tr>
<tr><th id="227">227</th><td><i>		// kneeHigh = 3.5f;</i>&nbsp</td></tr>
<tr><th id="228">228</th><td>		&nbsp</td></tr>
<tr><th id="229">229</th><td>		<em>float</em> <dfn class="local col1 decl" id="91fogR" title='fogR' data-type='float' data-ref="91fogR">fogR</dfn> = <var>0.0f</var>;&nbsp</td></tr>
<tr><th id="230">230</th><td>		<em>float</em> <dfn class="local col2 decl" id="92fogG" title='fogG' data-type='float' data-ref="92fogG">fogG</dfn> = <var>0.0f</var>;&nbsp</td></tr>
<tr><th id="231">231</th><td>		<em>float</em> <dfn class="local col3 decl" id="93fogB" title='fogB' data-type='float' data-ref="93fogB">fogB</dfn> = <var>0.0f</var>;&nbsp</td></tr>
<tr><th id="232">232</th><td>&nbsp</td></tr>
<tr><th id="233">233</th><td>		<i>// Save some time if we can.</i>&nbsp</td></tr>
<tr><th id="234">234</th><td>		<b>if</b> (defog &gt; <var>0.0f</var>)&nbsp</td></tr>
<tr><th id="235">235</th><td>			EXR::ComputeFogColour(fogR, fogG, fogB, <span class='error' title="use of undeclared identifier &apos;pixels&apos;">pixels</span>);&nbsp</td></tr>
<tr><th id="236">236</th><td>&nbsp</td></tr>
<tr><th id="237">237</th><td>		<span class='error' title="use of undeclared identifier &apos;halfFunction&apos;">halfFunction</span>&lt;<em>float</em>&gt;<span class='error' title="expected &apos;;&apos; after expression"></span> redGamma(<span class="namespace">EXR::</span><a class="tu ref fn" href="#_ZN3EXR5GammaC1Efffff" title='EXR::Gamma::Gamma' data-use='c' data-ref="_ZN3EXR5GammaC1Efffff"><a class="type" href="#EXR::Gamma" title='EXR::Gamma' data-ref="EXR::Gamma">Gamma</a></a>(<a class="local col9 ref" href="#69gamma" title='gamma' data-ref="69gamma">gamma</a>, <a class="local col6 ref" href="#66exposure" title='exposure' data-ref="66exposure">exposure</a>, <a class="local col5 ref" href="#65defog" title='defog' data-ref="65defog">defog</a> * <a class="local col1 ref" href="#91fogR" title='fogR' data-ref="91fogR">fogR</a>, <a class="local col7 ref" href="#67kneeLow" title='kneeLow' data-ref="67kneeLow">kneeLow</a>, <a class="local col8 ref" href="#68kneeHigh" title='kneeHigh' data-ref="68kneeHigh">kneeHigh</a>), -<span class='error' title="use of undeclared identifier &apos;HALF_MAX&apos;">HALF_MAX</span>, <span class='error' title="use of undeclared identifier &apos;HALF_MAX&apos;">HALF_MAX</span>, <var>0.0f</var>, <var>255.0f</var>, <var>0.0f</var>, <var>0.0f</var>);&nbsp</td></tr>
<tr><th id="238">238</th><td>		<span class='error' title="use of undeclared identifier &apos;halfFunction&apos;">halfFunction</span>&lt;<em>float</em>&gt;<span class='error' title="expected &apos;;&apos; after expression"></span> grnGamma(<span class="namespace">EXR::</span><a class="tu ref fn" href="#_ZN3EXR5GammaC1Efffff" title='EXR::Gamma::Gamma' data-use='c' data-ref="_ZN3EXR5GammaC1Efffff"><a class="type" href="#EXR::Gamma" title='EXR::Gamma' data-ref="EXR::Gamma">Gamma</a></a>(<a class="local col9 ref" href="#69gamma" title='gamma' data-ref="69gamma">gamma</a>, <a class="local col6 ref" href="#66exposure" title='exposure' data-ref="66exposure">exposure</a>, <a class="local col5 ref" href="#65defog" title='defog' data-ref="65defog">defog</a> * <a class="local col2 ref" href="#92fogG" title='fogG' data-ref="92fogG">fogG</a>, <a class="local col7 ref" href="#67kneeLow" title='kneeLow' data-ref="67kneeLow">kneeLow</a>, <a class="local col8 ref" href="#68kneeHigh" title='kneeHigh' data-ref="68kneeHigh">kneeHigh</a>), -<span class='error' title="use of undeclared identifier &apos;HALF_MAX&apos;">HALF_MAX</span>, <span class='error' title="use of undeclared identifier &apos;HALF_MAX&apos;">HALF_MAX</span>, <var>0.0f</var>, <var>255.0f</var>, <var>0.0f</var>, <var>0.0f</var>);&nbsp</td></tr>
<tr><th id="239">239</th><td>		<span class='error' title="use of undeclared identifier &apos;halfFunction&apos;">halfFunction</span>&lt;<em>float</em>&gt;<span class='error' title="expected &apos;;&apos; after expression"></span> bluGamma(<span class="namespace">EXR::</span><a class="tu ref fn" href="#_ZN3EXR5GammaC1Efffff" title='EXR::Gamma::Gamma' data-use='c' data-ref="_ZN3EXR5GammaC1Efffff"><a class="type" href="#EXR::Gamma" title='EXR::Gamma' data-ref="EXR::Gamma">Gamma</a></a>(<a class="local col9 ref" href="#69gamma" title='gamma' data-ref="69gamma">gamma</a>, <a class="local col6 ref" href="#66exposure" title='exposure' data-ref="66exposure">exposure</a>, <a class="local col5 ref" href="#65defog" title='defog' data-ref="65defog">defog</a> * <a class="local col3 ref" href="#93fogB" title='fogB' data-ref="93fogB">fogB</a>, <a class="local col7 ref" href="#67kneeLow" title='kneeLow' data-ref="67kneeLow">kneeLow</a>, <a class="local col8 ref" href="#68kneeHigh" title='kneeHigh' data-ref="68kneeHigh">kneeHigh</a>), -<span class='error' title="use of undeclared identifier &apos;HALF_MAX&apos;">HALF_MAX</span>, <span class='error' title="use of undeclared identifier &apos;HALF_MAX&apos;">HALF_MAX</span>, <var>0.0f</var>, <var>255.0f</var>, <var>0.0f</var>, <var>0.0f</var>);&nbsp</td></tr>
<tr><th id="240">240</th><td>&nbsp</td></tr>
<tr><th id="241">241</th><td>		<i>// Conversion from raw pixel data to data for the OpenGL frame buffer:</i>&nbsp</td></tr>
<tr><th id="242">242</th><td><i>		// 1) Compensate for fogging by subtracting defog from the raw pixel values.</i>&nbsp</td></tr>
<tr><th id="243">243</th><td><i>		// 2) Multiply the defogged pixel values by 2^(exposure + 2.47393).</i>&nbsp</td></tr>
<tr><th id="244">244</th><td><i>		// 3) Values that are now 1.0 are called "middle gray". If defog and exposure are both set to 0.0, then middle gray</i>&nbsp</td></tr>
<tr><th id="245">245</th><td><i>		//    corresponds to a raw pixel value of 0.18. In step 6, middle gray values will be mapped to an intensity 3.5</i>&nbsp</td></tr>
<tr><th id="246">246</th><td><i>		//    f-stops below the display's maximum intensity.</i>&nbsp</td></tr>
<tr><th id="247">247</th><td><i>		// 4) Apply a knee function. The knee function has two parameters, kneeLow and kneeHigh. Pixel values below</i>&nbsp</td></tr>
<tr><th id="248">248</th><td><i>		//    2^kneeLow are not changed by the knee function. Pixel values above kneeLow are lowered according to a</i>&nbsp</td></tr>
<tr><th id="249">249</th><td><i>		//    logarithmic curve, such that the value 2^kneeHigh is mapped to 2^3.5. (In step 6 this value will be mapped to</i>&nbsp</td></tr>
<tr><th id="250">250</th><td><i>		//    the the display's maximum intensity.)</i>&nbsp</td></tr>
<tr><th id="251">251</th><td><i>		// 5) Gamma-correct the pixel values, according to the screen's gamma. (We assume that the gamma curve is a simple</i>&nbsp</td></tr>
<tr><th id="252">252</th><td><i>		//    power function.)</i>&nbsp</td></tr>
<tr><th id="253">253</th><td><i>		// 6) Scale the values such that middle gray pixels are mapped to a frame buffer value that is 3.5 f-stops below the</i>&nbsp</td></tr>
<tr><th id="254">254</th><td><i>		//    display's maximum intensity. (84.65 if the screen's gamma is 2.2)</i>&nbsp</td></tr>
<tr><th id="255">255</th><td><i>		// 7) Clamp the values to [0, 255].</i>&nbsp</td></tr>
<tr><th id="256">256</th><td><i>		//</i>&nbsp</td></tr>
<tr><th id="257">257</th><td><i>		// Texview has 0,0 at bottom-left. Rows start from bottom.</i>&nbsp</td></tr>
<tr><th id="258">258</th><td>		<em>int</em> <dfn class="local col4 decl" id="94p" title='p' data-type='int' data-ref="94p">p</dfn> = <var>0</var>;&nbsp</td></tr>
<tr><th id="259">259</th><td>		<b>for</b> (<em>int</em> <dfn class="local col5 decl" id="95yi" title='yi' data-type='int' data-ref="95yi">yi</dfn> = <a class="local col9 ref" href="#89height" title='height' data-ref="89height">height</a>-<var>1</var>; <a class="local col5 ref" href="#95yi" title='yi' data-ref="95yi">yi</a> &gt;= <var>0</var>; <a class="local col5 ref" href="#95yi" title='yi' data-ref="95yi">yi</a>--)&nbsp</td></tr>
<tr><th id="260">260</th><td>		{&nbsp</td></tr>
<tr><th id="261">261</th><td>			<b>for</b> (<em>int</em> <dfn class="local col6 decl" id="96xi" title='xi' data-type='int' data-ref="96xi">xi</dfn> = <var>0</var>; <a class="local col6 ref" href="#96xi" title='xi' data-ref="96xi">xi</a> &lt; <a class="local col8 ref" href="#88width" title='width' data-ref="88width">width</a>; <a class="local col6 ref" href="#96xi" title='xi' data-ref="96xi">xi</a>++)&nbsp</td></tr>
<tr><th id="262">262</th><td>			{&nbsp</td></tr>
<tr><th id="263">263</th><td>				<em>int</em> <dfn class="local col7 decl" id="97idx" title='idx' data-type='int' data-ref="97idx">idx</dfn> = <a class="local col5 ref" href="#95yi" title='yi' data-ref="95yi">yi</a>*<a class="local col8 ref" href="#88width" title='width' data-ref="88width">width</a> + <a class="local col6 ref" href="#96xi" title='xi' data-ref="96xi">xi</a>;&nbsp</td></tr>
<tr><th id="264">264</th><td>				<em>const</em> <span class='error' title="use of undeclared identifier &apos;IMF&apos;">IMF</span>::Rgba&amp; <dfn class="local col8 decl" id="98rawPixel" title='rawPixel' data-type='const int &amp;' data-ref="98rawPixel">rawPixel</dfn> = <span class='error' title="use of undeclared identifier &apos;pixels&apos;">pixels</span>[idx];&nbsp</td></tr>
<tr><th id="265">265</th><td>				newFrame-&gt;Pixels[p++] = tPixel4b&nbsp</td></tr>
<tr><th id="266">266</th><td>				(&nbsp</td></tr>
<tr><th id="267">267</th><td>					EXR::Dither( redGamma(rawPixel.r), xi, yi ),&nbsp</td></tr>
<tr><th id="268">268</th><td>					EXR::Dither( grnGamma(rawPixel.g), xi, yi ),&nbsp</td></tr>
<tr><th id="269">269</th><td>					EXR::Dither( bluGamma(rawPixel.b), xi, yi ),&nbsp</td></tr>
<tr><th id="270">270</th><td>					uint8( tMath::tClamp( tMath::tFloatToInt(<em>float</em>(rawPixel.a)*<var>255.0f</var>), <var>0</var>, <var>0xFF</var> ) )&nbsp</td></tr>
<tr><th id="271">271</th><td>				);&nbsp</td></tr>
<tr><th id="272">272</th><td>			}&nbsp</td></tr>
<tr><th id="273">273</th><td>		}&nbsp</td></tr>
<tr><th id="274">274</th><td>&nbsp</td></tr>
<tr><th id="275">275</th><td>		<a class="member field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::Frames" title='tImage::tImageEXR::Frames' data-ref="tImage::tImageEXR::Frames">Frames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZN5tList6AppendEPT_" title='tList::Append' data-ref="_ZN5tList6AppendEPT_">Append</a>(<span class='inlayHint'>item:&nbsp;</span><a class="local col0 ref" href="#90newFrame" title='newFrame' data-ref="90newFrame">newFrame</a>);&nbsp</td></tr>
<tr><th id="276">276</th><td>	}&nbsp</td></tr>
<tr><th id="277">277</th><td>&nbsp</td></tr>
<tr><th id="278">278</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormat" title='tImage::tBaseImage::PixelFormat' data-ref="tImage::tBaseImage::PixelFormat">PixelFormat</a> = <a class="type" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat" title='tImage::tPixelFormat' data-ref="tImage::tPixelFormat">tPixelFormat</a>::<a class="enum" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat::R8G8B8A8" title='tImage::tPixelFormat::R8G8B8A8' data-ref="tImage::tPixelFormat::R8G8B8A8">R8G8B8A8</a>;&nbsp</td></tr>
<tr><th id="279">279</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormatSrc" title='tImage::tBaseImage::PixelFormatSrc' data-ref="tImage::tBaseImage::PixelFormatSrc">PixelFormatSrc</a> = <a class="type" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat" title='tImage::tPixelFormat' data-ref="tImage::tPixelFormat">tPixelFormat</a>::<a class="enum" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat::OPENEXR" title='tImage::tPixelFormat::OPENEXR' data-ref="tImage::tPixelFormat::OPENEXR">OPENEXR</a>;&nbsp</td></tr>
<tr><th id="280">280</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::ColourProfile" title='tImage::tBaseImage::ColourProfile' data-ref="tImage::tBaseImage::ColourProfile">ColourProfile</a> = <a class="type" href="../../Math/Inc/Math/tColour.h.html#tColourProfile" title='tColourProfile' data-ref="tColourProfile">tColourProfile</a>::<a class="enum" href="../../Math/Inc/Math/tColour.h.html#tColourProfile::sRGB" title='tColourProfile::sRGB' data-ref="tColourProfile::sRGB">sRGB</a>;&nbsp</td></tr>
<tr><th id="281">281</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::ColourProfileSrc" title='tImage::tBaseImage::ColourProfileSrc' data-ref="tImage::tBaseImage::ColourProfileSrc">ColourProfileSrc</a> = <a class="type" href="../../Math/Inc/Math/tColour.h.html#tColourProfile" title='tColourProfile' data-ref="tColourProfile">tColourProfile</a>::<a class="enum" href="../../Math/Inc/Math/tColour.h.html#tColourProfile::HDRa" title='tColourProfile::HDRa' data-ref="tColourProfile::HDRa">HDRa</a>;&nbsp</td></tr>
<tr><th id="282">282</th><td>	<b>return</b> <b>true</b>;&nbsp</td></tr>
<tr><th id="283">283</th><td>}&nbsp</td></tr>
<tr><th id="284">284</th><td>&nbsp</td></tr>
<tr><th id="285">285</th><td>&nbsp</td></tr>
<tr><th id="286">286</th><td><em>bool</em> <span class="namespace">tImage::</span><a class="type" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR" title='tImage::tImageEXR' data-ref="tImage::tImageEXR">tImageEXR</a>::<dfn class="decl def fn" id="_ZN6tImage9tImageEXR3SetER5tListINS_6tFrameEEb" title='tImage::tImageEXR::Set' data-ref="_ZN6tImage9tImageEXR3SetER5tListINS_6tFrameEEb">Set</dfn>(<a class="type" href="../../Foundation/Inc/Foundation/tList.h.html#tList" title='tList' data-ref="tList">tList</a>&lt;<a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a>&gt;&amp; <dfn class="local col9 decl" id="99srcFrames" title='srcFrames' data-type='tList&lt;tImage::tFrame&gt; &amp;' data-ref="99srcFrames">srcFrames</dfn>, <em>bool</em> <dfn class="local col0 decl" id="100stealFrames" title='stealFrames' data-type='bool' data-ref="100stealFrames">stealFrames</dfn>)&nbsp</td></tr>
<tr><th id="287">287</th><td>{&nbsp</td></tr>
<tr><th id="288">288</th><td>	<a class="virtual member fn" href="../Inc/Image/tImageEXR.h.html#_ZN6tImage9tImageEXR5ClearEv" title='tImage::tImageEXR::Clear' data-ref="_ZN6tImage9tImageEXR5ClearEv">Clear</a>();&nbsp</td></tr>
<tr><th id="289">289</th><td>	<b>if</b> (<a class="local col9 ref" href="#99srcFrames" title='srcFrames' data-ref="99srcFrames">srcFrames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZNK5tList11GetNumItemsEv" title='tList::GetNumItems' data-ref="_ZNK5tList11GetNumItemsEv">GetNumItems</a>() &lt;= <var>0</var>)&nbsp</td></tr>
<tr><th id="290">290</th><td>		<b>return</b> <b>false</b>;&nbsp</td></tr>
<tr><th id="291">291</th><td>&nbsp</td></tr>
<tr><th id="292">292</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormatSrc" title='tImage::tBaseImage::PixelFormatSrc' data-ref="tImage::tBaseImage::PixelFormatSrc">PixelFormatSrc</a>		= <a class="local col9 ref" href="#99srcFrames" title='srcFrames' data-ref="99srcFrames">srcFrames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZNK5tList4HeadEv" title='tList::Head' data-ref="_ZNK5tList4HeadEv">Head</a>()-&gt;<a class="ref field" href="../Inc/Image/tFrame.h.html#tImage::tFrame::PixelFormatSrc" title='tImage::tFrame::PixelFormatSrc' data-ref="tImage::tFrame::PixelFormatSrc">PixelFormatSrc</a>;&nbsp</td></tr>
<tr><th id="293">293</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormat" title='tImage::tBaseImage::PixelFormat' data-ref="tImage::tBaseImage::PixelFormat">PixelFormat</a>			= <a class="type" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat" title='tImage::tPixelFormat' data-ref="tImage::tPixelFormat">tPixelFormat</a>::<a class="enum" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat::R8G8B8A8" title='tImage::tPixelFormat::R8G8B8A8' data-ref="tImage::tPixelFormat::R8G8B8A8">R8G8B8A8</a>;&nbsp</td></tr>
<tr><th id="294">294</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::ColourProfileSrc" title='tImage::tBaseImage::ColourProfileSrc' data-ref="tImage::tBaseImage::ColourProfileSrc">ColourProfileSrc</a>	= <a class="type" href="../../Math/Inc/Math/tColour.h.html#tColourProfile" title='tColourProfile' data-ref="tColourProfile">tColourProfile</a>::<a class="enum" href="../../Math/Inc/Math/tColour.h.html#tColourProfile::sRGB" title='tColourProfile::sRGB' data-ref="tColourProfile::sRGB">sRGB</a>;		<i>// We assume srcFrames must be sRGB.</i>&nbsp</td></tr>
<tr><th id="295">295</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::ColourProfile" title='tImage::tBaseImage::ColourProfile' data-ref="tImage::tBaseImage::ColourProfile">ColourProfile</a>		= <a class="type" href="../../Math/Inc/Math/tColour.h.html#tColourProfile" title='tColourProfile' data-ref="tColourProfile">tColourProfile</a>::<a class="enum" href="../../Math/Inc/Math/tColour.h.html#tColourProfile::sRGB" title='tColourProfile::sRGB' data-ref="tColourProfile::sRGB">sRGB</a>;&nbsp</td></tr>
<tr><th id="296">296</th><td>&nbsp</td></tr>
<tr><th id="297">297</th><td>	<b>if</b> (<a class="local col0 ref" href="#100stealFrames" title='stealFrames' data-ref="100stealFrames">stealFrames</a>)&nbsp</td></tr>
<tr><th id="298">298</th><td>	{&nbsp</td></tr>
<tr><th id="299">299</th><td>		<b>while</b> (<a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a>* <dfn class="local col1 decl" id="101frame" title='frame' data-type='tImage::tFrame *' data-ref="101frame"><a class="local col1 ref" href="#101frame" title='frame' data-ref="101frame">frame</a></dfn> = <a class="local col9 ref" href="#99srcFrames" title='srcFrames' data-ref="99srcFrames">srcFrames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZN5tList6RemoveEv" title='tList::Remove' data-ref="_ZN5tList6RemoveEv">Remove</a>())&nbsp</td></tr>
<tr><th id="300">300</th><td>			<a class="member field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::Frames" title='tImage::tImageEXR::Frames' data-ref="tImage::tImageEXR::Frames">Frames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZN5tList6AppendEPT_" title='tList::Append' data-ref="_ZN5tList6AppendEPT_">Append</a>(<span class='inlayHint'>item:&nbsp;</span><a class="local col1 ref" href="#101frame" title='frame' data-ref="101frame">frame</a>);&nbsp</td></tr>
<tr><th id="301">301</th><td>	}&nbsp</td></tr>
<tr><th id="302">302</th><td>	<b>else</b>&nbsp</td></tr>
<tr><th id="303">303</th><td>	{&nbsp</td></tr>
<tr><th id="304">304</th><td>		<b>for</b> (<a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a>* <dfn class="local col2 decl" id="102frame" title='frame' data-type='tImage::tFrame *' data-ref="102frame">frame</dfn> = <a class="local col9 ref" href="#99srcFrames" title='srcFrames' data-ref="99srcFrames">srcFrames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZNK5tList4HeadEv" title='tList::Head' data-ref="_ZNK5tList4HeadEv">Head</a>(); <a class="local col2 ref" href="#102frame" title='frame' data-ref="102frame">frame</a>; <a class="local col2 ref" href="#102frame" title='frame' data-ref="102frame">frame</a> = <a class="local col2 ref" href="#102frame" title='frame' data-ref="102frame">frame</a>-&gt;<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZNK5tLink4NextEv" title='tLink::Next' data-ref="_ZNK5tLink4NextEv">Next</a>())&nbsp</td></tr>
<tr><th id="305">305</th><td>			<a class="member field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::Frames" title='tImage::tImageEXR::Frames' data-ref="tImage::tImageEXR::Frames">Frames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZN5tList6AppendEPT_" title='tList::Append' data-ref="_ZN5tList6AppendEPT_">Append</a>(<span class='inlayHint'>item:&nbsp;</span><b>new</b> <a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a><a class="ref fn" href="../Inc/Image/tFrame.h.html#_ZN6tImage6tFrameC1ERKS0_" title='tImage::tFrame::tFrame' data-ref="_ZN6tImage6tFrameC1ERKS0_">(</a>*<a class="local col2 ref" href="#102frame" title='frame' data-ref="102frame">frame</a>));&nbsp</td></tr>
<tr><th id="306">306</th><td>	}&nbsp</td></tr>
<tr><th id="307">307</th><td>&nbsp</td></tr>
<tr><th id="308">308</th><td>	<b>return</b> <b>true</b>;&nbsp</td></tr>
<tr><th id="309">309</th><td>}&nbsp</td></tr>
<tr><th id="310">310</th><td>&nbsp</td></tr>
<tr><th id="311">311</th><td>&nbsp</td></tr>
<tr><th id="312">312</th><td><em>bool</em> <a class="type" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR" title='tImage::tImageEXR' data-ref="tImage::tImageEXR">tImageEXR</a>::<dfn class="virtual decl def fn" id="_ZN6tImage9tImageEXR3SetEP9tColour4biib" title='tImage::tImageEXR::Set' data-ref="_ZN6tImage9tImageEXR3SetEP9tColour4biib">Set</dfn>(<a class="typedef" href="../../Math/Inc/Math/tColour.h.html#tPixel4b" title='tPixel4b' data-type='tColour4b' data-ref="tPixel4b">tPixel4b</a>* <dfn class="local col3 decl" id="103pixels" title='pixels' data-type='tPixel4b *' data-ref="103pixels">pixels</dfn>, <em>int</em> <dfn class="local col4 decl" id="104width" title='width' data-type='int' data-ref="104width">width</dfn>, <em>int</em> <dfn class="local col5 decl" id="105height" title='height' data-type='int' data-ref="105height">height</dfn>, <em>bool</em> <dfn class="local col6 decl" id="106steal" title='steal' data-type='bool' data-ref="106steal">steal</dfn>)&nbsp</td></tr>
<tr><th id="313">313</th><td>{&nbsp</td></tr>
<tr><th id="314">314</th><td>	<a class="virtual member fn" href="../Inc/Image/tImageEXR.h.html#_ZN6tImage9tImageEXR5ClearEv" title='tImage::tImageEXR::Clear' data-ref="_ZN6tImage9tImageEXR5ClearEv">Clear</a>();&nbsp</td></tr>
<tr><th id="315">315</th><td>	<b>if</b> (!<a class="local col3 ref" href="#103pixels" title='pixels' data-ref="103pixels">pixels</a> || (<a class="local col4 ref" href="#104width" title='width' data-ref="104width">width</a> &lt;= <var>0</var>) || (<a class="local col5 ref" href="#105height" title='height' data-ref="105height">height</a> &lt;= <var>0</var>))&nbsp</td></tr>
<tr><th id="316">316</th><td>		<b>return</b> <b>false</b>;&nbsp</td></tr>
<tr><th id="317">317</th><td>&nbsp</td></tr>
<tr><th id="318">318</th><td>	<a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a>* <dfn class="local col7 decl" id="107frame" title='frame' data-type='tImage::tFrame *' data-ref="107frame">frame</dfn> = <b>new</b> <a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a><a class="ref fn" href="../Inc/Image/tFrame.h.html#_ZN6tImage6tFrameC1Ev" title='tImage::tFrame::tFrame' data-ref="_ZN6tImage6tFrameC1Ev">(</a>);&nbsp</td></tr>
<tr><th id="319">319</th><td>	<b>if</b> (<a class="local col6 ref" href="#106steal" title='steal' data-ref="106steal">steal</a>)&nbsp</td></tr>
<tr><th id="320">320</th><td>		<a class="local col7 ref" href="#107frame" title='frame' data-ref="107frame">frame</a>-&gt;<a class="ref fn" href="../Inc/Image/tFrame.h.html#_ZN6tImage6tFrame9StealFromEP9tColour4biif" title='tImage::tFrame::StealFrom' data-ref="_ZN6tImage6tFrame9StealFromEP9tColour4biif">StealFrom</a>(<span class='inlayHint'>src:&nbsp;</span><a class="local col3 ref" href="#103pixels" title='pixels' data-ref="103pixels">pixels</a>, <a class="local col4 ref" href="#104width" title='width' data-ref="104width">width</a>, <a class="local col5 ref" href="#105height" title='height' data-ref="105height">height</a>);&nbsp</td></tr>
<tr><th id="321">321</th><td>	<b>else</b>&nbsp</td></tr>
<tr><th id="322">322</th><td>		<a class="local col7 ref" href="#107frame" title='frame' data-ref="107frame">frame</a>-&gt;<a class="ref fn" href="../Inc/Image/tFrame.h.html#_ZN6tImage6tFrame3SetEPK9tColour4biif" title='tImage::tFrame::Set' data-ref="_ZN6tImage6tFrame3SetEPK9tColour4biif">Set</a>(<span class='inlayHint'>srcPixels:&nbsp;</span><a class="local col3 ref" href="#103pixels" title='pixels' data-ref="103pixels">pixels</a>, <a class="local col4 ref" href="#104width" title='width' data-ref="104width">width</a>, <a class="local col5 ref" href="#105height" title='height' data-ref="105height">height</a>);&nbsp</td></tr>
<tr><th id="323">323</th><td>	<a class="member field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::Frames" title='tImage::tImageEXR::Frames' data-ref="tImage::tImageEXR::Frames">Frames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZN5tList6AppendEPT_" title='tList::Append' data-ref="_ZN5tList6AppendEPT_">Append</a>(<span class='inlayHint'>item:&nbsp;</span><a class="local col7 ref" href="#107frame" title='frame' data-ref="107frame">frame</a>);&nbsp</td></tr>
<tr><th id="324">324</th><td>&nbsp</td></tr>
<tr><th id="325">325</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormatSrc" title='tImage::tBaseImage::PixelFormatSrc' data-ref="tImage::tBaseImage::PixelFormatSrc">PixelFormatSrc</a>		= <a class="type" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat" title='tImage::tPixelFormat' data-ref="tImage::tPixelFormat">tPixelFormat</a>::<a class="enum" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat::R8G8B8A8" title='tImage::tPixelFormat::R8G8B8A8' data-ref="tImage::tPixelFormat::R8G8B8A8">R8G8B8A8</a>;&nbsp</td></tr>
<tr><th id="326">326</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormat" title='tImage::tBaseImage::PixelFormat' data-ref="tImage::tBaseImage::PixelFormat">PixelFormat</a>			= <a class="type" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat" title='tImage::tPixelFormat' data-ref="tImage::tPixelFormat">tPixelFormat</a>::<a class="enum" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat::R8G8B8A8" title='tImage::tPixelFormat::R8G8B8A8' data-ref="tImage::tPixelFormat::R8G8B8A8">R8G8B8A8</a>;&nbsp</td></tr>
<tr><th id="327">327</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::ColourProfileSrc" title='tImage::tBaseImage::ColourProfileSrc' data-ref="tImage::tBaseImage::ColourProfileSrc">ColourProfileSrc</a>	= <a class="type" href="../../Math/Inc/Math/tColour.h.html#tColourProfile" title='tColourProfile' data-ref="tColourProfile">tColourProfile</a>::<a class="enum" href="../../Math/Inc/Math/tColour.h.html#tColourProfile::sRGB" title='tColourProfile::sRGB' data-ref="tColourProfile::sRGB">sRGB</a>;		<i>// We assume pixels must be sRGB.</i>&nbsp</td></tr>
<tr><th id="328">328</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::ColourProfile" title='tImage::tBaseImage::ColourProfile' data-ref="tImage::tBaseImage::ColourProfile">ColourProfile</a>		= <a class="type" href="../../Math/Inc/Math/tColour.h.html#tColourProfile" title='tColourProfile' data-ref="tColourProfile">tColourProfile</a>::<a class="enum" href="../../Math/Inc/Math/tColour.h.html#tColourProfile::sRGB" title='tColourProfile::sRGB' data-ref="tColourProfile::sRGB">sRGB</a>;&nbsp</td></tr>
<tr><th id="329">329</th><td>&nbsp</td></tr>
<tr><th id="330">330</th><td>	<b>return</b> <b>true</b>;&nbsp</td></tr>
<tr><th id="331">331</th><td>}&nbsp</td></tr>
<tr><th id="332">332</th><td>&nbsp</td></tr>
<tr><th id="333">333</th><td>&nbsp</td></tr>
<tr><th id="334">334</th><td><em>bool</em> <a class="type" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR" title='tImage::tImageEXR' data-ref="tImage::tImageEXR">tImageEXR</a>::<dfn class="virtual decl def fn" id="_ZN6tImage9tImageEXR3SetEPNS_6tFrameEb" title='tImage::tImageEXR::Set' data-ref="_ZN6tImage9tImageEXR3SetEPNS_6tFrameEb">Set</dfn>(<a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a>* <dfn class="local col8 decl" id="108frame" title='frame' data-type='tImage::tFrame *' data-ref="108frame">frame</dfn>, <em>bool</em> <dfn class="local col9 decl" id="109steal" title='steal' data-type='bool' data-ref="109steal">steal</dfn>)&nbsp</td></tr>
<tr><th id="335">335</th><td>{&nbsp</td></tr>
<tr><th id="336">336</th><td>	<a class="virtual member fn" href="../Inc/Image/tImageEXR.h.html#_ZN6tImage9tImageEXR5ClearEv" title='tImage::tImageEXR::Clear' data-ref="_ZN6tImage9tImageEXR5ClearEv">Clear</a>();&nbsp</td></tr>
<tr><th id="337">337</th><td>	<b>if</b> (!<a class="local col8 ref" href="#108frame" title='frame' data-ref="108frame">frame</a> || !<a class="local col8 ref" href="#108frame" title='frame' data-ref="108frame">frame</a>-&gt;<a class="ref fn" href="../Inc/Image/tFrame.h.html#_ZNK6tImage6tFrame7IsValidEv" title='tImage::tFrame::IsValid' data-ref="_ZNK6tImage6tFrame7IsValidEv">IsValid</a>())&nbsp</td></tr>
<tr><th id="338">338</th><td>		<b>return</b> <b>false</b>;&nbsp</td></tr>
<tr><th id="339">339</th><td>&nbsp</td></tr>
<tr><th id="340">340</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormatSrc" title='tImage::tBaseImage::PixelFormatSrc' data-ref="tImage::tBaseImage::PixelFormatSrc">PixelFormatSrc</a>		= <a class="local col8 ref" href="#108frame" title='frame' data-ref="108frame">frame</a>-&gt;<a class="ref field" href="../Inc/Image/tFrame.h.html#tImage::tFrame::PixelFormatSrc" title='tImage::tFrame::PixelFormatSrc' data-ref="tImage::tFrame::PixelFormatSrc">PixelFormatSrc</a>;&nbsp</td></tr>
<tr><th id="341">341</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormat" title='tImage::tBaseImage::PixelFormat' data-ref="tImage::tBaseImage::PixelFormat">PixelFormat</a>			= <a class="type" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat" title='tImage::tPixelFormat' data-ref="tImage::tPixelFormat">tPixelFormat</a>::<a class="enum" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat::R8G8B8A8" title='tImage::tPixelFormat::R8G8B8A8' data-ref="tImage::tPixelFormat::R8G8B8A8">R8G8B8A8</a>;&nbsp</td></tr>
<tr><th id="342">342</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::ColourProfileSrc" title='tImage::tBaseImage::ColourProfileSrc' data-ref="tImage::tBaseImage::ColourProfileSrc">ColourProfileSrc</a>	= <a class="type" href="../../Math/Inc/Math/tColour.h.html#tColourProfile" title='tColourProfile' data-ref="tColourProfile">tColourProfile</a>::<a class="enum" href="../../Math/Inc/Math/tColour.h.html#tColourProfile::sRGB" title='tColourProfile::sRGB' data-ref="tColourProfile::sRGB">sRGB</a>;		<i>// We assume frame must be sRGB.</i>&nbsp</td></tr>
<tr><th id="343">343</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::ColourProfile" title='tImage::tBaseImage::ColourProfile' data-ref="tImage::tBaseImage::ColourProfile">ColourProfile</a>		= <a class="type" href="../../Math/Inc/Math/tColour.h.html#tColourProfile" title='tColourProfile' data-ref="tColourProfile">tColourProfile</a>::<a class="enum" href="../../Math/Inc/Math/tColour.h.html#tColourProfile::sRGB" title='tColourProfile::sRGB' data-ref="tColourProfile::sRGB">sRGB</a>;&nbsp</td></tr>
<tr><th id="344">344</th><td>&nbsp</td></tr>
<tr><th id="345">345</th><td>	<b>if</b> (<a class="local col9 ref" href="#109steal" title='steal' data-ref="109steal">steal</a>)&nbsp</td></tr>
<tr><th id="346">346</th><td>		<a class="member field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::Frames" title='tImage::tImageEXR::Frames' data-ref="tImage::tImageEXR::Frames">Frames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZN5tList6AppendEPT_" title='tList::Append' data-ref="_ZN5tList6AppendEPT_">Append</a>(<span class='inlayHint'>item:&nbsp;</span><a class="local col8 ref" href="#108frame" title='frame' data-ref="108frame">frame</a>);&nbsp</td></tr>
<tr><th id="347">347</th><td>	<b>else</b>&nbsp</td></tr>
<tr><th id="348">348</th><td>		<a class="member field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::Frames" title='tImage::tImageEXR::Frames' data-ref="tImage::tImageEXR::Frames">Frames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZN5tList6AppendEPT_" title='tList::Append' data-ref="_ZN5tList6AppendEPT_">Append</a>(<span class='inlayHint'>item:&nbsp;</span><b>new</b> <a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a><a class="ref fn" href="../Inc/Image/tFrame.h.html#_ZN6tImage6tFrameC1ERKS0_" title='tImage::tFrame::tFrame' data-ref="_ZN6tImage6tFrameC1ERKS0_">(</a>*<a class="local col8 ref" href="#108frame" title='frame' data-ref="108frame">frame</a>));&nbsp</td></tr>
<tr><th id="349">349</th><td>&nbsp</td></tr>
<tr><th id="350">350</th><td>	<b>return</b> <b>true</b>;&nbsp</td></tr>
<tr><th id="351">351</th><td>}&nbsp</td></tr>
<tr><th id="352">352</th><td>&nbsp</td></tr>
<tr><th id="353">353</th><td>&nbsp</td></tr>
<tr><th id="354">354</th><td><em>bool</em> <a class="type" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR" title='tImage::tImageEXR' data-ref="tImage::tImageEXR">tImageEXR</a>::<dfn class="virtual decl def fn" id="_ZN6tImage9tImageEXR3SetERNS_8tPictureEb" title='tImage::tImageEXR::Set' data-ref="_ZN6tImage9tImageEXR3SetERNS_8tPictureEb">Set</dfn>(<a class="type" href="../Inc/Image/tPicture.h.html#tImage::tPicture" title='tImage::tPicture' data-ref="tImage::tPicture">tPicture</a>&amp; <dfn class="local col0 decl" id="110picture" title='picture' data-type='tImage::tPicture &amp;' data-ref="110picture">picture</dfn>, <em>bool</em> <dfn class="local col1 decl" id="111steal" title='steal' data-type='bool' data-ref="111steal">steal</dfn>)&nbsp</td></tr>
<tr><th id="355">355</th><td>{&nbsp</td></tr>
<tr><th id="356">356</th><td>	<a class="virtual member fn" href="../Inc/Image/tImageEXR.h.html#_ZN6tImage9tImageEXR5ClearEv" title='tImage::tImageEXR::Clear' data-ref="_ZN6tImage9tImageEXR5ClearEv">Clear</a>();&nbsp</td></tr>
<tr><th id="357">357</th><td>	<b>if</b> (!<a class="local col0 ref" href="#110picture" title='picture' data-ref="110picture">picture</a>.<a class="ref fn" href="../Inc/Image/tPicture.h.html#_ZNK6tImage8tPicture7IsValidEv" title='tImage::tPicture::IsValid' data-ref="_ZNK6tImage8tPicture7IsValidEv">IsValid</a>())&nbsp</td></tr>
<tr><th id="358">358</th><td>		<b>return</b> <b>false</b>;&nbsp</td></tr>
<tr><th id="359">359</th><td>&nbsp</td></tr>
<tr><th id="360">360</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormatSrc" title='tImage::tBaseImage::PixelFormatSrc' data-ref="tImage::tBaseImage::PixelFormatSrc">PixelFormatSrc</a>		= <a class="local col0 ref" href="#110picture" title='picture' data-ref="110picture">picture</a>.<a class="ref field" href="../Inc/Image/tPicture.h.html#tImage::tPicture::PixelFormatSrc" title='tImage::tPicture::PixelFormatSrc' data-ref="tImage::tPicture::PixelFormatSrc">PixelFormatSrc</a>;&nbsp</td></tr>
<tr><th id="361">361</th><td>	<a class="member field" href="../Inc/Image/tBaseImage.h.html#tImage::tBaseImage::PixelFormat" title='tImage::tBaseImage::PixelFormat' data-ref="tImage::tBaseImage::PixelFormat">PixelFormat</a>			= <a class="type" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat" title='tImage::tPixelFormat' data-ref="tImage::tPixelFormat">tPixelFormat</a>::<a class="enum" href="../Inc/Image/tPixelFormat.h.html#tImage::tPixelFormat::R8G8B8A8" title='tImage::tPixelFormat::R8G8B8A8' data-ref="tImage::tPixelFormat::R8G8B8A8">R8G8B8A8</a>;&nbsp</td></tr>
<tr><th id="362">362</th><td>	<i>// We don't know colour profile of tPicture.</i>&nbsp</td></tr>
<tr><th id="363">363</th><td><i></i>&nbsp</td></tr>
<tr><th id="364">364</th><td><i>	// This is worth some explanation. If steal is true the picture becomes invalid and the</i>&nbsp</td></tr>
<tr><th id="365">365</th><td><i>	// 'set' call will steal the stolen pixels. If steal is false GetPixels is called and the</i>&nbsp</td></tr>
<tr><th id="366">366</th><td><i>	// 'set' call will memcpy them out... which makes sure the picture is still valid after and</i>&nbsp</td></tr>
<tr><th id="367">367</th><td><i>	// no-one is sharing the pixel buffer. We don't check the success of 'set' because it must</i>&nbsp</td></tr>
<tr><th id="368">368</th><td><i>	// succeed if picture was valid.</i>&nbsp</td></tr>
<tr><th id="369">369</th><td>	<a class="typedef" href="../../Math/Inc/Math/tColour.h.html#tPixel4b" title='tPixel4b' data-type='tColour4b' data-ref="tPixel4b">tPixel4b</a>* <dfn class="local col2 decl" id="112pixels" title='pixels' data-type='tPixel4b *' data-ref="112pixels">pixels</dfn> = <a class="local col1 ref" href="#111steal" title='steal' data-ref="111steal">steal</a> ? <a class="local col0 ref" href="#110picture" title='picture' data-ref="110picture">picture</a>.<a class="ref fn" href="../Inc/Image/tPicture.h.html#_ZN6tImage8tPicture11StealPixelsEv" title='tImage::tPicture::StealPixels' data-ref="_ZN6tImage8tPicture11StealPixelsEv">StealPixels</a>() : <a class="local col0 ref" href="#110picture" title='picture' data-ref="110picture">picture</a>.<a class="ref fn" href="../Inc/Image/tPicture.h.html#_ZNK6tImage8tPicture9GetPixelsEv" title='tImage::tPicture::GetPixels' data-ref="_ZNK6tImage8tPicture9GetPixelsEv">GetPixels</a>();&nbsp</td></tr>
<tr><th id="370">370</th><td>	<em>bool</em> <dfn class="local col3 decl" id="113success" title='success' data-type='bool' data-ref="113success">success</dfn> = <a class="virtual member fn" href="#_ZN6tImage9tImageEXR3SetEP9tColour4biib" title='tImage::tImageEXR::Set' data-ref="_ZN6tImage9tImageEXR3SetEP9tColour4biib">Set</a>(<a class="local col2 ref" href="#112pixels" title='pixels' data-ref="112pixels">pixels</a>, <span class='inlayHint'>width:&nbsp;</span><a class="local col0 ref" href="#110picture" title='picture' data-ref="110picture">picture</a>.<a class="ref fn" href="../Inc/Image/tPicture.h.html#_ZNK6tImage8tPicture8GetWidthEv" title='tImage::tPicture::GetWidth' data-ref="_ZNK6tImage8tPicture8GetWidthEv">GetWidth</a>(), <span class='inlayHint'>height:&nbsp;</span><a class="local col0 ref" href="#110picture" title='picture' data-ref="110picture">picture</a>.<a class="ref fn" href="../Inc/Image/tPicture.h.html#_ZNK6tImage8tPicture9GetHeightEv" title='tImage::tPicture::GetHeight' data-ref="_ZNK6tImage8tPicture9GetHeightEv">GetHeight</a>(), <a class="local col1 ref" href="#111steal" title='steal' data-ref="111steal">steal</a>);&nbsp</td></tr>
<tr><th id="371">371</th><td>	<a class="macro" href="../../Foundation/Inc/Foundation/tAssert.h.html#26" title="if (!(success)) tAssertPrintBreak(&quot;success&quot;, &quot;/mnt/c/GitHub/tacent/Modules/Image/Src/tImageEXR.cpp&quot;, 371, nullptr)" data-ref="_M/tAssert">tAssert</a>(<a class="local col3 ref" href="#113success" title='success' data-ref="113success">success</a>);&nbsp</td></tr>
<tr><th id="372">372</th><td>	<b>return</b> <b>true</b>;&nbsp</td></tr>
<tr><th id="373">373</th><td>}&nbsp</td></tr>
<tr><th id="374">374</th><td>&nbsp</td></tr>
<tr><th id="375">375</th><td>&nbsp</td></tr>
<tr><th id="376">376</th><td><a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a>* <a class="type" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR" title='tImage::tImageEXR' data-ref="tImage::tImageEXR">tImageEXR</a>::<dfn class="virtual decl def fn" id="_ZN6tImage9tImageEXR8GetFrameEb" title='tImage::tImageEXR::GetFrame' data-ref="_ZN6tImage9tImageEXR8GetFrameEb">GetFrame</dfn>(<em>bool</em> <dfn class="local col4 decl" id="114steal" title='steal' data-type='bool' data-ref="114steal">steal</dfn>)&nbsp</td></tr>
<tr><th id="377">377</th><td>{&nbsp</td></tr>
<tr><th id="378">378</th><td>	<b>if</b> (!<a class="virtual member fn" href="../Inc/Image/tImageEXR.h.html#_ZNK6tImage9tImageEXR7IsValidEv" title='tImage::tImageEXR::IsValid' data-ref="_ZNK6tImage9tImageEXR7IsValidEv">IsValid</a>())&nbsp</td></tr>
<tr><th id="379">379</th><td>		<b>return</b> <b>nullptr</b>;&nbsp</td></tr>
<tr><th id="380">380</th><td>&nbsp</td></tr>
<tr><th id="381">381</th><td>	<b>return</b> <a class="local col4 ref" href="#114steal" title='steal' data-ref="114steal">steal</a> ? <a class="member field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::Frames" title='tImage::tImageEXR::Frames' data-ref="tImage::tImageEXR::Frames">Frames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZN5tList6RemoveEv" title='tList::Remove' data-ref="_ZN5tList6RemoveEv">Remove</a>() : <b>new</b> <a class="type" href="../Inc/Image/tFrame.h.html#tImage::tFrame" title='tImage::tFrame' data-ref="tImage::tFrame">tFrame</a><a class="ref fn" href="../Inc/Image/tFrame.h.html#_ZN6tImage6tFrameC1ERKS0_" title='tImage::tFrame::tFrame' data-ref="_ZN6tImage6tFrameC1ERKS0_">(</a> *<a class="member field" href="../Inc/Image/tImageEXR.h.html#tImage::tImageEXR::Frames" title='tImage::tImageEXR::Frames' data-ref="tImage::tImageEXR::Frames">Frames</a>.<a class="ref fn" href="../../Foundation/Inc/Foundation/tList.h.html#_ZNK5tList5FirstEv" title='tList::First' data-ref="_ZNK5tList5FirstEv">First</a>() );&nbsp</td></tr>
<tr><th id="382">382</th><td>}&nbsp</td></tr>
<tr><th id="383">383</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2025-Aug-23</em><br />Powered by Woboq Code Browser 2.1
<br/></p>
</div></body></html>
